<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Unity | ZZNEWCLEAR13</title>
<meta name=keywords content><meta name=description content="è¿™é‡Œæ˜¯zznewclear13çš„ï¼Œåˆ†äº«åˆ«å¤„æ‰¾ä¸åˆ°çš„å›¾å½¢å­¦å’ŒæŠ€æœ¯ç¾æœ¯ç›¸å…³å†…å®¹çš„ï¼Œä¸ªäººç½‘ç«™ã€‚"><meta name=author content="zznewclear13"><link rel=canonical href=https://zznewclear13.github.io/categories/unity/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://zznewclear13.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zznewclear13.github.io/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://zznewclear13.github.io/favicon.ico><link rel=apple-touch-icon href=https://zznewclear13.github.io/favicon.ico><link rel=mask-icon href=https://zznewclear13.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://zznewclear13.github.io/categories/unity/index.xml><link rel=alternate hreflang=en href=https://zznewclear13.github.io/categories/unity/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-JZ0FQH1VK5"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JZ0FQH1VK5",{anonymize_ip:!1})}</script><meta property="og:title" content="Unity"><meta property="og:description" content="è¿™é‡Œæ˜¯zznewclear13çš„ï¼Œåˆ†äº«åˆ«å¤„æ‰¾ä¸åˆ°çš„å›¾å½¢å­¦å’ŒæŠ€æœ¯ç¾æœ¯ç›¸å…³å†…å®¹çš„ï¼Œä¸ªäººç½‘ç«™ã€‚"><meta property="og:type" content="website"><meta property="og:url" content="https://zznewclear13.github.io/categories/unity/"><meta property="og:image" content="https://zznewclear13.github.io/images/address.png"><meta property="og:site_name" content="ZZNEWCLEAR13"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zznewclear13.github.io/images/address.png"><meta name=twitter:title content="Unity"><meta name=twitter:description content="è¿™é‡Œæ˜¯zznewclear13çš„ï¼Œåˆ†äº«åˆ«å¤„æ‰¾ä¸åˆ°çš„å›¾å½¢å­¦å’ŒæŠ€æœ¯ç¾æœ¯ç›¸å…³å†…å®¹çš„ï¼Œä¸ªäººç½‘ç«™ã€‚"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zznewclear13.github.io/ accesskey=h title="ZZNEWCLEAR13 (Alt + H)"><img src=https://zznewclear13.github.io/apple-touch-icon.png alt aria-label=logo height=35>ZZNEWCLEAR13</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://zznewclear13.github.io/now/ title=è¿›è¡Œæ—¶><span>è¿›è¡Œæ—¶</span></a></li><li><a href=https://zznewclear13.github.io/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://zznewclear13.github.io/categories/ title=åˆ†ç±»><span>åˆ†ç±»</span></a></li><li><a href=https://zznewclear13.github.io/links/ title=å‹æƒ…é“¾æ¥><span>å‹æƒ…é“¾æ¥</span></a></li><li><a href=https://zznewclear13.github.io/search/ title="ğŸ” (Alt + /)" accesskey=/><span>ğŸ”</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://zznewclear13.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://zznewclear13.github.io/categories/>Categories</a></div><h1>Unity</h1></header><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://zznewclear13.github.io/posts/images/ShadowBiasComparison.png alt="Shadow Bias Comparison Cover"></figure><header class=entry-header><h2 class=entry-hint-parent>åœ¨URPçš„ç‰‡å…ƒç€è‰²å™¨ä¸­åº”ç”¨é˜´å½±åç§»</h2></header><div class=entry-content><p>Shadow Bias æœ‰å…³Shadow Biasçš„ä»‹ç»æˆ‘åªæ¨èçœ‹è¿™ç¯‡çŸ¥ä¹æ–‡ç« è‡ªé€‚åº”Shadow Biasç®—æ³•ï¼Œé‡Œé¢ä»‹ç»äº†æœ‰å…³Shadow Biasçš„å‡ ä¹æ‰€æœ‰éœ€è¦äº†è§£çš„ä¿¡æ¯ã€‚åŒæ—¶è¿™ç¯‡æ–‡ç« ä¹ŸæŒ‡å‡ºäº†Unityç›®å‰æ­£åœ¨ä½¿ç”¨çš„Shadow Caster Vertex Based Biasæ–¹æ³•çš„ä¸è¶³ä¹‹å¤„ã€‚
å¦‚æœæ˜¯å¹³æ—¶ä½¿ç”¨URPçš„è¯ï¼ŒUnityä½¿ç”¨çš„åœ¨ç»˜åˆ¶Shadow Caster Passæ—¶å°†ShadowBiasæ·»åŠ åˆ°é¡¶ç‚¹çš„åç§»ä¸Šçš„æ–¹æ³•ï¼Œè™½ç„¶ç§°ä¸ä¸Šå°½å–„å°½ç¾ï¼Œä½†æ˜¯ä¹Ÿå®Œå…¨å¤Ÿç”¨äº†ã€‚ä½†æ˜¯åœ¨äºŒæ¬¡å…ƒè§’è‰²æ¸²æŸ“çš„æ—¶å€™ï¼Œä¸ºäº†è¥é€ ä¸è¢œå‹’è‚‰çš„æ•ˆæœï¼Œä¼šåœ¨è…¿éƒ¨çš„æ¨¡å‹å’Œä¸è¢œçš„æ¨¡å‹äº¤æ¥çš„åŒºåŸŸåšä¸€ä¸ªå‘å†…å‡¹é™·çš„æ•ˆæœã€‚è¿™ä¸ªåŒºåŸŸä¸¤ä¾§çš„æ¨¡å‹æ˜¯æ­£å¸¸é—­åˆçš„ï¼Œå…¶æ³•çº¿æ˜¯ç›¸å¯¹çš„ï¼Œæ­¤æ—¶å¦‚æœä½¿ç”¨Unityé»˜è®¤çš„ä½¿ç”¨ShadowBiaså»è°ƒæ•´é¡¶ç‚¹ä½ç½®çš„æ–¹å¼ï¼ŒShadowBiasä¸­çš„NormalBiaså°±ä¼šå¯¼è‡´è¿™ä¸ªåŒºåŸŸä¸¤ä¾§çš„æ¨¡å‹æœç€æ³•çº¿çš„åæ–¹å‘åç§»ï¼Œå¯¼è‡´è¿™ä¸ªåŒºåŸŸçš„é˜´å½±åœ¨æŸäº›è§’åº¦æ—¶ä¼šå‡ºç°æ¼æ´ï¼Œå¯ä»¥åœ¨æ–‡ç« å°é¢å›¾çš„å·¦è¾¹çœ‹åˆ°æ˜æ˜¾çš„ç‘•ç–µï¼Œå³è¾¹åˆ™æ˜¯åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ä½¿ç”¨äº†ShadowBiasï¼Œçœ‹ä¸Šå»çš„æ•ˆæœå°±æ¯”è¾ƒæ­£å¸¸äº†ï¼Œè€Œä¸”è§’è‰²çš„é˜´å½±å’Œè§’è‰²çš„æ¨¡å‹çš„å¤§å°ä¹ŸåŸºæœ¬ä¿æŒä¸€è‡´ã€‚å½“ç„¶äº†ï¼ŒæŠŠNormalBiasè®¾ç½®æˆ0å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜äº†ï¼Œä½†æ˜¯å¤±å»äº†NormalBiasåˆ™ä¼šå¸¦æ¥å…¶ä»–è§’åº¦çš„é˜´å½±çš„ç‘•ç–µã€‚
æœ¬æ–‡ä½¿ç”¨çš„æ˜¯Unity2022.3.43f1c1ï¼ŒURPç‰ˆæœ¬æ˜¯14.0.11ã€‚
å…³äºShadows.hlslçš„ç¢ç¢å¿µ æˆ‘è®¨åŒUnity URP Packageé‡Œçš„Shadows.hlslï¼Œå› ä¸ºå®ƒä½¿ç”¨äº†ä¸€ä¸ªLerpWhiteToçš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å®šä¹‰åœ¨CoreRPçš„CommonMaterial.hlslé‡Œï¼Œè€Œä¸çŸ¥é“ä¸ºä»€ä¹ˆShadows.hlslå¹¶æ²¡æœ‰åŒ…å«è¿™ä¸ªCommonMaterialï¼Œè¿™å°±å¯¼è‡´äº†æˆ‘åªæƒ³å•ç‹¬ä½¿ç”¨Shadows.hlslæ—¶ï¼Œå¿…é¡»è¿˜å¾—æ‰‹åŠ¨åŒ…å«ä¸€éCommonMaterial.hlslï¼Œæˆ‘è§‰å¾—è¿™å¾ˆä¸åˆç†ã€‚
æ›´è¦å‘½çš„æ˜¯ï¼Œå¦‚æœåœ¨hlslä¸­æƒ³è¦ä½¿ç”¨URPçš„Lightç»“æ„ä½“ï¼Œå°±èµ·ç å¾—åŒ…å«RealtimeLights.hlslï¼Œè¿™ä¸ªhlslåˆåŒ…å«äº†Shadows.hlslã€‚ç´¢æ€§æˆ‘å°±ç›´æ¥ä»è¿™äº›æ–‡ä»¶ä¸­æ‘˜å–äº†ä¸€å¥—è‡ªå·±çš„uber_lights.hlslå’Œuber_shadows.hlslï¼Œè¿™ä¹Ÿæ–¹ä¾¿åç»­åšä¿®æ”¹ã€‚
å¯¹äºURPçš„ä¿®æ”¹ è™½ç„¶æˆ‘çš„æƒ³æ³•æ˜¯å°½é‡åšåˆ°å³æ’å³ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å°½é‡ä¸å»ä¿®æ”¹URPé»˜è®¤çš„ä»£ç ï¼Œä½†æ˜¯å¾ˆé—æ†¾ä¸ºäº†å°†ShadowBiasç§»åŠ¨åˆ°ç‰‡å…ƒç€è‰²å™¨é‡Œï¼Œè¿˜æ˜¯å¾—ç¨ä½œä¿®æ”¹ã€‚
URPè®¾ç½®ShadowBiasæ˜¯åœ¨ç»˜åˆ¶çº§è”é˜´å½±çš„æ¯ä¸€ä¸ªsliceçš„æ—¶å€™ï¼Œå°†å…¶ä½œä¸ºå‚æ•°ä¼ ç»™é¡¶ç‚¹ç€è‰²å™¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è™½ç„¶é¡¶ç‚¹ç€è‰²å™¨ä¸­çš„å‚æ•°åªæœ‰_ShadowBiasä¸€ä¸ªï¼Œå®é™…ä¸ŠUnityä¼šä½¿ç”¨çº§è”é˜´å½±çš„å±‚çº§æ•°ä¸ªShadowBiasï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ä¿å­˜èµ·æ¥ï¼Œåœ¨æ¸²æŸ“LitForwardPassçš„æ—¶å€™ï¼Œæ ¹æ®å½“å‰åƒç´ çš„ä¸–ç•Œåæ ‡æ‰¾åˆ°å¯¹åº”çš„çº§è”é˜´å½±çš„å±‚çº§ï¼Œå†æŸ¥æ‰¾å¯¹åº”çš„ShadowBiasè¿›è¡Œè®¡ç®—ã€‚
MainLightShadowCasterPass.cs ä¸»è¦æ˜¯åœ¨MainLightShadowCasterPass.csçš„RenderMainLightCascadeShadowmapæ–¹æ³•ä¸­ï¼Œè®¡ç®—å¾—åˆ°äº†å½“å‰å±‚çº§çš„ShadowBiasä¹‹åï¼Œå°†å…¶ä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ç•™å¾…åç»­ä½¿ç”¨ã€‚
for (int cascadeIndex = 0; cascadeIndex &lt; m_ShadowCasterCascadesCount; ++cascadeIndex) { settings.splitData = m_CascadeSlices[cascadeIndex].splitData; Vector4 shadowBias = ShadowUtils.GetShadowBias(ref shadowLight, shadowLightIndex, ref renderingData.shadowData, m_CascadeSlices[cascadeIndex].projectionMatrix, m_CascadeSlices[cascadeIndex].resolution); m_MainLightShadowBiases[cascadeIndex] = shadowBias; // Shadow Biases for fragment shader. ShadowUtils.SetupShadowCasterConstantBuffer(cmd, ref shadowLight, shadowBias); CoreUtils.SetKeyword(cmd, ShaderKeywordStrings.CastingPunctualLightShadow, false); ShadowUtils.RenderShadowSlice(cmd, ref context, ref m_CascadeSlices[cascadeIndex], ref settings, m_CascadeSlices[cascadeIndex]....</p></div><footer class=entry-footer><span title='2024-10-05 12:00:00 +0800 CST'>October 5, 2024</span>&nbsp;Â·&nbsp;zznewclear13</footer><a class=entry-link aria-label="post link to åœ¨URPçš„ç‰‡å…ƒç€è‰²å™¨ä¸­åº”ç”¨é˜´å½±åç§»" href=https://zznewclear13.github.io/posts/unity-urp-apply-shadow-bias-in-fragment-shader/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://zznewclear13.github.io/posts/images/ScreenSpaceContactShadow.png alt="Screen Space Contact Shadow Cover"></figure><header class=entry-header><h2 class=entry-hint-parent>ä½¿ç”¨Compute Shaderè®¡ç®—å±å¹•ç©ºé—´æ¥è§¦é˜´å½±</h2></header><div class=entry-content><p>å±å¹•ç©ºé—´æ¥è§¦é˜´å½± å±å¹•ç©ºé—´æ¥è§¦é˜´å½±æ˜¯ç”¨æ¥è§£å†³æ™®é€šçš„é˜´å½±è´´å›¾ç²¾åº¦ä¸å¤Ÿçš„é—®é¢˜è€Œæå‡ºæ¥çš„ä¸€ç§é€šè¿‡æ·±åº¦å›¾åœ¨å±å¹•ç©ºé—´è®¡ç®—é˜´å½±çš„æ–¹æ³•ã€‚ç´¢å°¼çš„Bend Studioçš„Graham Aldridgeåœ¨Sigraph 2023çš„ç´¢å°¼åˆ›ä½œè€…å¤§ä¼šä¸Šï¼Œä»‹ç»äº†å¾€æ—¥ä¸å†ï¼ˆDays Goneï¼‰ä¸­è®¡ç®—å±å¹•ç©ºé—´æ¥è§¦é˜´å½±çš„æ–¹å¼ï¼Œè¿™é‡Œå¯ä»¥æ‰¾åˆ°æ¼”ç¤ºæ–‡ç¨¿å’Œå‚è€ƒä»£ç ã€‚
æœ¬ç¯‡æ–‡ç« ç›¸å½“äºæ˜¯Radial Dispatchç³»åˆ—çš„ç¬¬ä¸‰ç¯‡æ–‡ç« äº†ï¼Œä¸ä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ ·ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯åŸºäºå¾„å‘åˆ†æ´¾Compute Shaderä¸­ç›¸å…³ç®—æ³•çš„å®é™…åº”ç”¨ï¼Œå…·ä½“çš„ç¼“å­˜æ–¹å¼ä¹Ÿå¯ä»¥å‚è€ƒä¸Šä¸€ç¯‡æ–‡ç« ä½¿ç”¨Group Shared MemoryåŠ é€Ÿå¾„å‘æ¨¡ç³Šï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚å®é™…ä¸Šæˆ‘å‘ç°äº†è¿™æ ·è®¡ç®—æ¥è§¦é˜´å½±çš„ä¸€ä¸ªç¼ºé™·ï¼Œå°±æ˜¯ä¸å¤ªå¥½è®¡ç®—è½¯é˜´å½±äº†ï¼Œç”±äºç¼“å­˜çš„é™åˆ¶ï¼Œéšæœºé‡‡æ ·åªèƒ½åœ¨ä¸€ä¸ªå¾ˆå°çš„èŒƒå›´å†…åˆ†å¸ƒï¼ŒåŸºæœ¬ä¸Šç”¨ä¸ä¸Šäº†ã€‚ç”±äºä½¿ç”¨çš„æ˜¯å±å¹•ç©ºé—´çš„æ·±åº¦å›¾çš„ä¿¡æ¯ï¼ŒåŠ ä¸Šåšåº¦æ£€æµ‹ä¹‹åå¾ˆå®¹æ˜“å‡ºç°æ¼é¢çš„é—®é¢˜ï¼Œå°é¢ä¸­çš„ç‘•ç–µä¹Ÿæœ‰ä¸€éƒ¨åˆ†æ˜¯æ¥è‡ªäºæˆ‘çš„Relaxed Cone Step Mappingæœ¬èº«æ·±åº¦å€¼çš„ç‘•ç–µï¼Œå±å¹•ä¸ŠåŠéƒ¨åˆ†çš„é˜´å½±å°±å¥½å¾ˆå¤šã€‚è¿™å°±å½“ä½œæ˜¯ä¸€ä¸ªProof of Conceptå§ï¼Œä¹‹åæœ‰æœºä¼šçš„è¯å†å›æ¥ä¼˜åŒ–ä¼˜åŒ–ã€‚
æœ¬æ–‡ä½¿ç”¨çš„æ˜¯Unity 2022.3.21f1ï¼ŒURPç‰ˆæœ¬æ˜¯14.0.10ã€‚
å…·ä½“çš„ä»£ç  ContactShadowComputeShader.compute æ ¸å¿ƒçš„ä»£ç æ¥è‡ªäºå‰ä¸€ç¯‡æ–‡ç« å¾„å‘åˆ†æ´¾Compute Shaderã€‚å‰ä¸€ç¯‡æ–‡ç« åœ¨å¾ªç¯ä¸­æ˜¯é€šè¿‡ç»Ÿä¸€æ­¥é•¿è¿›è¡Œé‡‡æ ·çš„ï¼Œä¼šé‡‡æ ·åˆ°å››ä¸ªåƒç´ ä¸­é—´å› æ­¤éœ€è¦åŒçº¿æ€§æ’å€¼ï¼Œè¿™æ¬¡æˆ‘ä»¬å›ºå®šæ°´å¹³æˆ–è€…ç«–ç›´æ–¹å‘çš„æ­¥é•¿ä¸ºä¸€ä¸ªåƒç´ ï¼Œè¿™æ ·æˆ‘ä»¬åªéœ€è¦åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šè¿›è¡Œçº¿æ€§æ’å€¼äº†ã€‚ç”±äºæ·±åº¦å’Œé¢œè‰²ä¿¡æ¯æ˜¯ä¸¤ç§ä¸åŒçš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ä»…å¯¹è·ç¦»å¾ˆè¿‘çš„æ·±åº¦è¿›è¡Œçº¿æ€§æ’å€¼ï¼Œå¯¹äºè·ç¦»è¾ƒè¿œçš„ä¸¤ä¸ªæ·±åº¦å€¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¦»é‡‡æ ·ç‚¹æœ€è¿‘åƒç´ çš„æ·±åº¦å€¼ã€‚è‡³äºå¦‚ä½•åˆ¤æ–­æ·±åº¦è¿œè¿‘ï¼Œæˆ‘ä½¿ç”¨äº†å’Œå±å¹•ç©ºé—´åå°„ä¸­ç›¸åŒçš„_ThicknessParamsï¼Œé»˜è®¤ç‰©ä½“çš„åšåº¦ä¸ºlinearSampleDepth * _Thickness.y + _Thickness.xã€‚
#pragma kernel ContactShadowPoint #pragma kernel ClearMain // #pragma warning(disable: 3556) #include "Packages/com.unity.render-pipelines.core/ShaderLibrary/Common.hlsl" #include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl" #define THREAD_COUNT 128 Texture2D&lt;float4> _ColorTex; Texture2D&lt;float> _CameraDepthTexture; RWTexture2D&lt;float4> _RW_TargetTex; float3 _LightPosWS; float4 _LightPosCS; float2 _LightPosSS; float2 _ThicknessParams; float4 _TextureSize; float _LightRange; float _Debug; struct DispatchParams { int2 offset; int count; int stride; int xMajor; }; StructuredBuffer&lt;DispatchParams> _DispatchData; int GetDispatchType(int index, out int dispatchIndex, out DispatchParams dispatchParams) { for (int i=0; i&lt;8; ++i) { dispatchParams = _DispatchData[i]; dispatchIndex = dispatchParams....</p></div><footer class=entry-footer><span title='2024-04-20 12:00:00 +0800 CST'>April 20, 2024</span>&nbsp;Â·&nbsp;zznewclear13</footer><a class=entry-link aria-label="post link to ä½¿ç”¨Compute Shaderè®¡ç®—å±å¹•ç©ºé—´æ¥è§¦é˜´å½±" href=https://zznewclear13.github.io/posts/calculate-screen-space-contact-shadow-using-compute-shader/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://zznewclear13.github.io/posts/images/RadialBlur.png alt="Radial Blur Cover"></figure><header class=entry-header><h2 class=entry-hint-parent>ä½¿ç”¨Group Shared MemoryåŠ é€Ÿå¾„å‘æ¨¡ç³Š</h2></header><div class=entry-content><p>å¾„å‘æ¨¡ç³Š åœ¨å†™äº†ä¸Šä¸€ç¯‡æ–‡ç« å¾„å‘åˆ†æ´¾Compute Shaderä¹‹åï¼Œå¾ˆè‡ªç„¶çš„å°±éœ€è¦ç”¨å¾„å‘æ¨¡ç³Šæ¥æ£€éªŒæˆ‘ä»¬çš„ç®—æ³•ã€‚
å¾„å‘æ¨¡ç³Šçš„æ•ˆæœåœ¨ç½‘ä¸Šå¯ä»¥è¯´æ˜¯ä¸€æ‰¾ä¸€å¤§å †äº†ï¼Œç™¾åˆ†ä¹‹ä¹åäº”çš„æ•™ç¨‹ï¼Œä¼šä½¿ç”¨ä¸€ä¸ªå¾ˆå¤§çš„å¾ªç¯é‡å¤é‡‡æ ·çº¹ç†ï¼Œç™¾åˆ†ä¹‹å››ç‚¹ä¹çš„æ•™ç¨‹ï¼Œä¼šä½¿ç”¨å¤špassçš„æ–¹æ³•å‡å°‘é‡‡æ ·çš„æ¬¡æ•°ï¼ˆå½“ç„¶è¿™äº›æ•°å­—æ˜¯æˆ‘çç¼–çš„ï¼Œæˆ‘è¿˜ç•™äº†ç™¾åˆ†ä¹‹é›¶ç‚¹ä¸€ï¼Œä»¥é˜²çœŸçš„æœ‰äººä¹Ÿç”¨Compute Shaderåšäº†å¾„å‘æ¨¡ç³Šï¼‰ã€‚è¿™ç¯‡æ–‡ç« å°±æ¥æ¢è®¨å¦‚ä½•ä½¿ç”¨Compute Shaderä¸­çš„Group Shared Memoryæ¥åŠ é€Ÿå¾„å‘æ¨¡ç³Šçš„è®¡ç®—ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨ä¸€ä¸ªCompute Shaderä¸­å®ç°è¶…å¤§æ¨¡ç³Šè·ç¦»(ç”šè‡³èƒ½è¶…è¿‡128åƒç´ )çš„å¾„å‘æ¨¡ç³Šã€‚
ç¼“å­˜é¢œè‰²ä¿¡æ¯ ç…§ä¾‹æˆ‘ä»¬è¦å†çœ‹ä¸€éç´¢å°¼çš„Bend Studioçš„Graham Aldridgeåœ¨Sigraph 2023çš„ç´¢å°¼åˆ›ä½œè€…å¤§ä¼šä¸Šï¼Œä»‹ç»çš„å¾€æ—¥ä¸å†ï¼ˆDays Goneï¼‰ä¸­è®¡ç®—å±å¹•ç©ºé—´æ¥è§¦é˜´å½±çš„æ–¹å¼ï¼Œè¿™é‡Œå¯ä»¥æ‰¾åˆ°æ¼”ç¤ºæ–‡ç¨¿å’Œå‚è€ƒä»£ç ã€‚æ¼”ç¤ºæ–‡ç¨¿çš„ç¬¬24-25é¡µä»‹ç»äº†å¦‚ä½•åœ¨Group Shared Memoryä¸­ç¼“å­˜æ·±åº¦ä¿¡æ¯ï¼Œå½“ç„¶åœ¨å¾„å‘æ¨¡ç³Šä¸­æˆ‘ä»¬ç¼“å­˜çš„æ˜¯é¢œè‰²ä¿¡æ¯äº†ã€‚
ä¸‹å›¾æ˜¯ç¼“å­˜é¢œè‰²ä¿¡æ¯çš„ç¤ºæ„å›¾ï¼Œç»¿è‰²æ–¹å—å¯¹åº”çš„åƒç´ æ˜¯æˆ‘ä»¬æ•´ä¸ªThread Groupçš„èµ·ç‚¹ï¼Œçº¢è‰²æ–¹å—æ˜¯æˆ‘ä»¬å½“å‰è®¡ç®—çš„åƒç´ ï¼Œé»‘è‰²å’Œç°è‰²çš„çº¿ä»£è¡¨äº†è¯¥åƒç´ åˆ°å¾„å‘æ¨¡ç³Šä¸­å¿ƒçš„æ–¹å‘ã€‚æˆ‘ä»¬çš„Thread Group Sizeæ˜¯12ï¼Œæ·±è“è‰²ï¼ˆåŒ…æ‹¬ç»¿è‰²å’Œçº¢è‰²ï¼‰çš„åƒç´ åŒå±äºä¸€ä¸ªThread Groupï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—è¿™äº›åƒç´ å¾„å‘æ¨¡ç³Šåçš„é¢œè‰²ã€‚æ·±è“è‰²ã€æµ…è“è‰²ã€ç°è‰²å’Œæµ…ç°è‰²ã€é•‚ç©ºçš„ç°è‰²å’Œæµ…ç°è‰²ï¼Œä»£è¡¨äº†æˆ‘ä»¬éœ€è¦ç¼“å­˜çš„é¢œè‰²ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å¯¹ç¼“å­˜çš„é¢œè‰²è¿›è¡ŒåŒçº¿æ€§æ’å€¼ï¼Œæˆ‘ä»¬é™¤äº†éœ€è¦ç¼“å­˜å°„çº¿ç»è¿‡çš„æœ€è¿‘çš„åƒç´ ï¼ˆå³è“è‰²åŒºåŸŸï¼‰å¤–ï¼Œè¿˜éœ€è¦ç¼“å­˜å°„çº¿ç»è¿‡çš„ç¬¬äºŒè¿‘çš„åƒç´ ï¼ˆå³ç°è‰²åŒºåŸŸï¼‰å’Œå°„çº¿ç»è¿‡çš„ç¬¬ä¸‰è¿‘çš„åƒç´ ï¼ˆå³é•‚ç©ºç°è‰²åŒºåŸŸï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´å½“Thread Group Sizeä¸º12æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç¼“å­˜6 * 12ä¸ªåƒç´ ï¼Œäº¦å³æ¯ä¸ªåƒç´ å…­æ¬¡é‡‡æ ·ã€‚
ä»…ç¼“å­˜ç¬¬äºŒè¿‘çš„åƒç´ åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹èƒ½å¤Ÿå¾—åˆ°æ­£ç¡®çš„åŒçº¿æ€§æ’å€¼ï¼Œä½†æ˜¯æ³¨æ„çœ‹çº¢è‰²æ–¹å—å‘å³çš„ç¬¬äºŒæ¬¡é‡‡æ ·ï¼Œä»…å¯¹è“è‰²å’Œå®å¿ƒç°è‰²åŒºåŸŸçš„é¢œè‰²è¿›è¡Œæ’å€¼æ˜¯ä¸èƒ½å¾—åˆ°æ­£ç¡®çš„é¢œè‰²çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é¢å¤–ç¼“å­˜é•‚ç©ºç°è‰²åŒºåŸŸçš„é¢œè‰²ï¼Œäº¦å³ç¬¬ä¸‰è¿‘çš„åƒç´ ã€‚
Group Shared Memoryåˆ†é… å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬çš„Group Shared Memoryçš„å¤§å°æ˜¯THREAD_COUNT * 6ï¼ˆæ‡’å¾—æŠŠTHREAD_COUNTç»Ÿä¸€æ”¹æˆTHREAD_GROUP_SIZEäº†ï¼‰ï¼Œå…¶ä¸­åŒ…å«äº†ä¸Šè¿°çš„æ·±è“è‰²ã€æµ…è“è‰²ã€ç°è‰²ã€æµ…ç°è‰²ã€é•‚ç©ºç°è‰²ã€é•‚ç©ºæµ…ç°è‰²åŒºåŸŸå¯¹åº”åƒç´ çš„é¢œè‰²ä¿¡æ¯ã€‚æ•°ç»„çš„é•¿åº¦æ˜¯THREAD_COUNT * 6ï¼Œåœ¨æˆ‘ä»¬ç¼“å­˜æ—¶ï¼Œæˆ‘ä»¬ä¼šå°†å…¶è§†ä¸º6è¡ŒTHREAD_COUNTåˆ—çš„è¡¨æ¥å‚¨å­˜é¢œè‰²ä¿¡æ¯ï¼Œè€Œåœ¨æˆ‘ä»¬è¯»å–æ—¶ï¼Œæˆ‘ä»¬ä¼šå°†å…¶è§†ä¸º3è¡ŒTHREAD_COUNT*2åˆ—çš„è¡¨æ¥è¯»å–æ•°æ®ã€‚
groupshared float3 cachedColor[THREAD_COUNT * 6]; void SetCachedColor(float3 color, int2 threadPos) {cachedColor[threadPos.x+threadPos.y*THREAD_COUNT]=color;} float3 GetCachedColor(int2 threadPos) {return cachedColor[threadPos.x+threadPos.y*THREAD_COUNT*2];} å…·ä½“çš„ä»£ç  RadialDispatchComputeShader.compute æ ¸å¿ƒçš„ä»£ç æ¥è‡ªäºä¸Šä¸€ç¯‡æ–‡ç« å¾„å‘åˆ†æ´¾Compute Shaderã€‚å¾ªç¯è¯»å–é¢œè‰²å€¼çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œå¯ä»¥ä¸¥æ ¼æŒ‰ç…§æ ¼ç‚¹æ¥è¯»å–ï¼Œè¿™æ ·åªéœ€è¦å¯¹yæ–¹å‘åšçº¿æ€§æ’å€¼ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§ç»Ÿä¸€çš„æ­¥é•¿æ¥è¯»å–ï¼Œè¿™æ ·éœ€è¦å¯¹xyæ–¹å‘éƒ½åšçº¿æ€§æ’å€¼ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ç»Ÿä¸€çš„æ­¥é•¿ã€‚æ¯ä¸€ç»„ç¼“å­˜çš„èµ·å§‹åƒç´ æ˜¯æœ€æ¥è¿‘äºå°„çº¿çš„åƒç´ çš„ä¸‹é¢ä¸€ä¸ªåƒç´ ï¼Œè¯»å–ç¼“å­˜ä½¿ç”¨çš„åç§»æ˜¯ç”¨çš„å½“å‰é‡‡æ ·ç‚¹ä¸‹ç¬¬ä¸€ä¸ªåƒç´ çš„åæ ‡å’Œå½“å‰ç¼“å­˜åˆ—æœ€ä¸‹é¢åƒç´ çš„åæ ‡ç›¸å‡ï¼Œè¿™é‡Œé¢æ¯”è¾ƒç»•ä¸å¤ªå¥½æè¿°ã€‚ã€‚ã€‚
#pragma kernel RadialBlurMain // #pragma warning(disable: 3556) #define THREAD_COUNT 128 Texture2D&lt;float4> _ColorTex; RWTexture2D&lt;float4> _RW_TargetTex; float2 _CenterPosSS; float4 _TextureSize; float _Intensity; struct DispatchParams { int2 offset; int count; int stride; int xMajor; }; StructuredBuffer&lt;DispatchParams> _DispatchData; int GetDispatchType(int index, out int dispatchIndex, out DispatchParams dispatchParams) { for (int i=0; i&lt;8; ++i) { dispatchParams = _DispatchData[i]; dispatchIndex = dispatchParams....</p></div><footer class=entry-footer><span title='2024-03-31 12:00:00 +0800 CST'>March 31, 2024</span>&nbsp;Â·&nbsp;zznewclear13</footer><a class=entry-link aria-label="post link to ä½¿ç”¨Group Shared MemoryåŠ é€Ÿå¾„å‘æ¨¡ç³Š" href=https://zznewclear13.github.io/posts/accelerate-radial-blur-using-group-shared-memory/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://zznewclear13.github.io/posts/images/RadiallyDispatchedComputeShader.png alt="Radially Dispatched Cover"></figure><header class=entry-header><h2 class=entry-hint-parent>å¾„å‘åˆ†æ´¾Compute Shader</h2></header><div class=entry-content><p>åŠ¨æœº æœ€ç›´æ¥çš„åŠ¨æœºæ˜¯æˆ‘æœ€è¿‘éœ€è¦å®ç°å±å¹•ç©ºé—´æ¥è§¦é˜´å½±äº†ã€‚ç´¢å°¼çš„Bend Studioçš„Graham Aldridgeåœ¨Sigraph 2023çš„ç´¢å°¼åˆ›ä½œè€…å¤§ä¼šä¸Šï¼Œä»‹ç»äº†å¾€æ—¥ä¸å†ï¼ˆDays Goneï¼‰ä¸­è®¡ç®—å±å¹•ç©ºé—´æ¥è§¦é˜´å½±çš„æ–¹å¼ï¼Œè¿™é‡Œå¯ä»¥æ‰¾åˆ°æ¼”ç¤ºæ–‡ç¨¿å’Œå‚è€ƒä»£ç ã€‚æ¼”ç¤ºæ–‡ç¨¿çš„ç¬¬24-27é¡µï¼Œå±•ç¤ºäº†ä¸€ç§æ–°é¢–çš„åˆ†æ´¾Compute Shaderçš„æ–¹æ³•ï¼Œä¼ ç»Ÿçš„åˆ†æ´¾Compute Shaderå¾€å¾€æ˜¯å°†ç”»é¢æ°´å¹³å’Œç«–ç›´åˆ‡åˆ†æˆåƒç´ æ•°é‡ä¸º64å€æ•°çš„å°å—ï¼Œå°†åˆ†æ´¾çš„Compute Shaderå¯¹åº”åˆ°è¿™äº›å°å—ä¸Šï¼Œè€ŒDays Goneä¸­åˆ™æ˜¯å°†åˆ†æ´¾çš„Compute Shaderå¯¹åº”åˆ°å‘ˆæ”¾å°„çŠ¶çš„åƒç´ å°å—ä¸Šã€‚å¤§è‡´çš„æ„æ€å¯ä»¥çœ‹ä¸‹å›¾ï¼Œä¸‹å›¾ä¸­ç›¸åŒé¢œè‰²çš„ç›¸é‚»åƒç´ å±äºåŒä¸€ä¸ªthread groupï¼Œå·¦è¾¹æ˜¯ä¼ ç»Ÿçš„åˆ†æ´¾æ–¹å¼ï¼Œå³è¾¹åˆ™æ˜¯å¾„å‘çš„åˆ†æ´¾æ–¹å¼ã€‚
å½“è¿›è¡Œå¾„å‘æ¨¡ç³Šæˆ–æ˜¯è®¡ç®—æ¥è§¦é˜´å½±æ—¶ï¼Œå¾€å¾€éœ€è¦æ²¿ç€æŸä¸ªæ–¹å‘è¿ç»­é‡‡æ ·çº¹ç†ã€‚å¯¹äºå¤šæ¬¡é‡‡æ ·ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæƒ³åˆ°ä½¿ç”¨Compute Shaderä¸­çš„Group Shared Memoryè¿›è¡Œç¼“å­˜ä»è€Œå‡å°‘é‡‡æ ·æ¬¡æ•°ã€‚ä½†æ˜¯å¯¹ç‰¹å®šæ–¹å‘è¿›è¡Œç¼“å­˜çš„è¯ï¼Œä¼šè¦ç¼“å­˜O((N+C)^2)ä¸ªé¢œè‰²ï¼Œå¦‚æœåˆ†æ´¾çš„Thread Group Sizeæˆ–æ˜¯æ­¥è¿›çš„æ¬¡æ•°æ¯”è¾ƒå¤§ï¼Œå¾ˆå®¹æ˜“å°±è¶…å‡ºäº†Group Shared Memoryçš„æœ€å¤§é™åˆ¶ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨å¾„å‘åˆ†æ´¾çš„æ–¹å¼ï¼Œå°†æ¯ä¸€ä¸ªThread Groupå¯¹åº”çš„åƒç´ æ²¿ç€é‡‡æ ·çš„æ–¹å‘æ’åˆ—ï¼Œç®—ä¸Šçº¿æ€§æ’å€¼ä¹Ÿåªéœ€è¦ç¼“å­˜(N+C)*2ä¸ªé¢œè‰²ï¼Œè¿™æ ·å°±èƒ½å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œè¾ƒè¿œçš„æ­¥è¿›äº†ã€‚
ç›¸è¾ƒäºç´¢å°¼çš„æ¼”ç¤ºï¼Œæœ¬æ–‡è§£å†³äº†Thread Groupå¯¹åº”çš„åƒç´ é‡å çš„é—®é¢˜ï¼Œä¹Ÿå°½é‡åœ°ä»‹ç»äº†è®¾ç½®åˆ†æ´¾å‚æ•°æ—¶çš„å„ç§æ¡ä»¶åˆ¤æ–­ã€‚æœ¬æ–‡ä½¿ç”¨çš„æ˜¯Unity 2022.3.21f1ï¼ŒURPç‰ˆæœ¬æ˜¯14.0.10ã€‚
å¦‚ä½•è¿›è¡Œå¾„å‘åˆ†æ´¾ åˆ†æ´¾æ–¹å¼å’ŒåŸå›  é¦–å…ˆæˆ‘ä»¬æ³¨æ„åˆ°å¯¹äºå±å¹•ä¸­æ‰€æœ‰æŒ‡å‘ä¸­å¿ƒçš„å°„çº¿ï¼Œå¯ä»¥å°†å…¶åˆ†ä¸ºå·¦ä¸‹ã€å·¦ä¸Šã€å³ä¸‹ã€å³ä¸Šå››ç§ï¼Œè¿™å››ç§å°„çº¿æœ€æ˜æ˜¾çš„æ˜¯ç¬¦å·ç›¸åï¼Œå› æ­¤åœ¨æˆ‘ä»¬åˆ†æ´¾çš„æ—¶å€™å¯ä»¥åˆ†æˆå››ç»„æ•°æ®ï¼Œæ¯ä¸€ç»„æ•°æ®ä½¿ç”¨åŒæ ·çš„æ–¹å¼æ‰¾åˆ°å¯¹åº”çš„åç§»å€¼ï¼Œå†ä¹˜ä¸Šç¬¦å·å’Œä¸­å¿ƒçš„åæ ‡ç›¸åŠ ï¼Œå°±èƒ½å¾—åˆ°å¯¹åº”çš„åƒç´ åæ ‡ã€‚
å› æ­¤æˆ‘ä»¬åªéœ€è¦è€ƒè™‘ä¸€ç§æƒ…å†µï¼Œæˆ‘ä»¬ä»¥å³ä¸Šè§’ä¸ºä¾‹ã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªå¾„å‘åˆ†æ´¾çš„ç¤ºæ„å›¾ï¼Œç»¿è‰²æ˜¯æˆ‘ä»¬çš„ä¸­å¿ƒç‚¹ï¼Œæ‰€æœ‰çš„Thread Groupéƒ½ä¼šä»¥ç»¿ç‚¹ä¸ºä¸­å¿ƒæ”¾å°„çŠ¶æ’å¸ƒï¼Œé»‘æ¡†å°±æ˜¯å±å¹•ä¸Šä¸­å¿ƒç‚¹å³ä¸Šè§’å¯¹åº”çš„åŒºåŸŸï¼ˆä¸ºäº†ç®€ä¾¿è¿™é‡Œé€‰å–äº†æ¯”è¾ƒå°çš„18x10åƒç´ ï¼‰ï¼Œè¿™é‡Œæ¯å››ä¸ªç›¸é‚»ç™½è‰²æ–¹æ¡†åŒå±äºä¸€ä¸ªThread Groupï¼ˆæ›´å¤šçš„Thread Groupæˆ‘æ²¡æœ‰ç”»å‡ºæ¥ï¼‰ï¼Œè“è‰²çš„åŒºåŸŸæ˜¯æ¯ä¸€ä¸ªThread Groupçš„èµ·ç‚¹ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°æ·±è“å’Œæµ…è“ä¸¤ç§é¢œè‰²ï¼Œå®ƒä»¬å¯¹åº”äº†ä¸¤ç§åˆ†æ´¾çš„è§„å¾‹ï¼Œä¸€ç§æ˜¯å‘ˆæ­£æ–¹å½¢çš„ï¼Œå¦ä¸€ç§åˆ™æ˜¯å‘ˆçŸ©å½¢çš„ï¼Œç°è‰²çš„åŒºåŸŸæ˜¯æ‰€æœ‰è®¡ç®—è€Œå¾—çš„æ¯ä¸€ä¸ªThreadå¯¹åº”çš„åƒç´ ï¼Œä¸ºäº†è®©ç°è‰²çš„åŒºåŸŸè¦†ç›–æ•´ä¸ªé»‘æ¡†çš„åŒºåŸŸï¼Œæˆ‘ä»¬éœ€è¦åšæ¯”å½“å‰åƒç´ æ›´å¤šçš„åˆ†æ´¾ã€‚
ç›´æ¥è®¡ç®—æ¯ä¸€ä¸ªThreadå¯¹åº”çš„åƒç´ ä¼¼ä¹æœ‰ç‚¹å›°éš¾ï¼Œæˆ‘ä»¬å¯ä»¥å°†åˆ†æ´¾åˆ†æˆä¸¤ä¸ªç»´åº¦ï¼Œç”¨ç¬¬ä¸€ä¸ªç»´åº¦è®¡ç®—Thread Groupçš„èµ·ç‚¹ï¼Œå³ä¸Šå›¾çš„è“è‰²åŒºåŸŸï¼Œç”¨ç¬¬äºŒä¸ªç»´åº¦å’ŒThread Groupçš„èµ·ç‚¹ï¼Œè®¡ç®—å¯¹åº”çš„åƒç´ çš„ä½ç½®ã€‚å› æ­¤æˆ‘ä»¬åˆ†æ´¾çš„æ•°æ®ä¹Ÿå°±å˜æˆäº†ä¸€ä¸ªGroupIDå’ŒGroupIndexäº†ã€‚æ³¨æ„åˆ°æµ…è“è‰²çš„åŒºåŸŸçš„ä½ç½®å†³å®šäºé»‘æ¡†çš„é•¿å®½æ¯”ï¼Œå½“é»‘æ¡†çš„é«˜å¤§äºé•¿æ—¶ï¼Œæµ…è“è‰²çš„åŒºåŸŸä¼šåœ¨æ·±è“è‰²çš„ä¸Šæ–¹ä¸”æ¨ªå‘æ’å¸ƒã€‚æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªxMajorçš„åˆ¤æ–­ï¼Œå¦‚æœä¸æ˜¯xMajorï¼Œæˆ‘ä»¬å°±è°ƒæ¢xyåˆ†é‡ï¼Œå…¨éƒ¨è®¡ç®—å®Œæ¯•ä¹‹åå†æ¢å›æ¥ã€‚
æ ¹æ®å›¾ä¸Šçš„æ·±è“è‰²å’Œæµ…è“è‰²åŒºåŸŸï¼Œæˆ‘ä»¬ä¼šå°†ä¸¤ä¸ªåŒºåŸŸåˆ†å¼€æ¥è®¡ç®—GroupIDã€‚æ¯”è¾ƒç®€å•çš„æ˜¯æµ…è“è‰²çš„åŒºåŸŸï¼Œä»æ•°å­¦ä¸Šæˆ‘ä»¬éœ€è¦ä¼ å…¥æ¯ä¸€åˆ—çš„åˆ—é«˜ï¼Œè®¡ç®—å‡ºGroupIDçš„åˆ—åºå·å’Œåœ¨ä¸€åˆ—ä¸­çš„åºå·ï¼Œå°±èƒ½å¾—åˆ°èµ·ç‚¹çš„åæ ‡äº†ã€‚æ·±è“è‰²çš„åŒºåŸŸï¼Œå¦‚æœå•çº¯å¯¹æ¯ä¸€åœˆæ±‚å’Œçš„è¯ï¼Œè¿™æ˜¯ä¸€ä¸ªäºŒæ¬¡æ–¹ç¨‹ï¼Œè™½ç„¶ä¹Ÿèƒ½è®¡ç®—ä½†æ•ˆç‡è‚¯å®šä¸ä¼šå¾ˆé«˜ã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘é«˜æ–¯æ±‚å’Œçš„æ–¹æ³•ï¼Œå°†ç¬¬ä¸€åœˆçš„ç«–å‘çš„åƒç´ å’Œæœ€åä¸€åœˆçš„æ¨ªå‘åƒç´ åˆå¹¶æˆä¸€åˆ—ï¼ˆä¹Ÿå°±æ˜¯å›¾ä¸Šæ·±è“è‰²æ–¹æ¡†å·¦ä¸Šè§’å›¾æ¡ˆç›¸åŒçš„ä¸ºåŒä¸€åˆ—ï¼‰ï¼Œè¿™æ ·å¾—åˆ°çš„æ¯ä¸€åˆ—çš„åˆ—é«˜éƒ½æ˜¯ç›¸åŒçš„ï¼Œå°±èƒ½ä½¿ç”¨æµ…è“è‰²åŒºåŸŸçš„æ–¹å¼è®¡ç®—åºå·äº†ï¼Œä¹‹åæˆ‘ä»¬å†å¯¹æ¯”è¾ƒåºå·çš„å¤§å°æ¥å†³å®šæ˜¯ç«–å‘çš„åƒç´ è¿˜æ˜¯æ¨ªå‘çš„åƒç´ ã€‚
å¾—åˆ°äº†Thread Groupçš„èµ·ç‚¹åæ ‡ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨èµ·ç‚¹åæ ‡åˆ°ä¸­å¿ƒçš„å‘é‡ï¼Œå¯¹Xæ–¹å‘æˆ–Yæ–¹å‘ä»¥1ä¸ºå•ä½æ­¥è¿›ï¼Œå†å¯¹å¦ä¸€ä¸ªæ–¹å‘å–æœ€è¿‘çš„æ•´æ•°ï¼Œå°±èƒ½å¾—åˆ°å½“å‰Threadå¯¹åº”çš„åƒç´ ç›¸å¯¹äºæ•´ä¸ªThread Groupèµ·ç‚¹åæ ‡çš„åç§»ï¼Œä¸¤è€…ç›¸åŠ å°±èƒ½å¾—åˆ°æœ€ç»ˆçš„åƒç´ åæ ‡äº†ã€‚
äº‹å®ä¸Šï¼Œæˆ‘ä»¬çš„ä¸­å¿ƒç‚¹æœ‰å¯èƒ½ä¼šåœ¨å±å¹•å¤–éƒ¨ï¼Œè¿™ä¸ªæ—¶å€™ä¸Šå›¾å°±ä¼šå˜æˆè¿™æ ·ï¼Œæˆ‘ä»¬åœ¨è®¡ç®—åˆ—é«˜çš„æ—¶å€™éœ€è¦é¢å¤–çš„è€ƒè™‘ä¸­å¿ƒç‚¹çš„åç§»ï¼Œæ·±è“è‰²çš„åŒºåŸŸä¹Ÿä¸ä¼šè€ƒè™‘å®Œå…¨åœ¨å±å¹•å¤–çš„åœˆã€‚
å¾„å‘åˆ†æ´¾çš„é¢å¤–å‚æ•° ä¸ºäº†åœ¨Compute Shaderä¸­è®¡ç®—æ¯ä¸ªThreadå¯¹åº”çš„åƒç´ ï¼Œæˆ‘ä»¬éœ€è¦ä»CPUé¢å¤–ä¼ é€’ä¸€äº›å‚æ•°ã€‚åœ¨å¾„å‘åˆ†æ´¾ä¸­ï¼Œæˆ‘ä»¬ä»SV_DispatchThreadIDä¸­è·å–åˆ°çš„å…¶å®æ˜¯GroupIDå’ŒGroupIndexä¸¤ä¸ªå‚æ•°ã€‚ç”±ä¸Šé¢çš„è®¨è®ºï¼Œæˆ‘ä»¬å°†æ‰€æœ‰æƒ…å†µåˆ†ä¸º4 * 2ç§ï¼Œå³å·¦ä¸‹ã€å·¦ä¸Šã€å³ä¸‹ã€å³ä¸Šã€æ·±è“ã€æµ…è“çš„ç»„åˆï¼Œå¯¹äºæ¯ä¸€ç§ç»„åˆæˆ‘ä»¬éœ€è¦çŸ¥é“æ€»çš„æ•°é‡ï¼Œæ‰èƒ½è®¡ç®—åœ¨æ¯ä¸€ç§ç»„åˆä¸­çš„GroupIDã€‚æ ¹æ®æˆ‘ä»¬ä¸Šè¿°çš„è®¡ç®—æ–¹å¼ï¼Œæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“æ¯ä¸€ç§ç»„åˆå¯¹åº”çš„åˆ—é«˜å’ŒxMajorçš„ä¿¡æ¯ã€‚ä¸ºäº†å…¼å®¹ä¸­å¿ƒç‚¹åœ¨å±å¹•å¤–çš„æƒ…å†µï¼Œæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“ä¸­å¿ƒç‚¹çš„åç§»å€¼ã€‚è¿™æ ·æˆ‘ä»¬çš„å‚æ•°å°±æ˜¯8ç»„5ä¸ªintå€¼ï¼Œåˆ†åˆ«å¯¹åº”åç§»å€¼Xï¼Œåç§»å€¼Yï¼Œå½“å‰æ€»Thread Groupæ•°ï¼Œåˆ—é«˜å’ŒxMajorï¼Œå…¶ä¸­xMajorå…¶å®æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼å¯ä»¥å°è£…åˆ°åˆ—é«˜çš„ç¬¬ä¸€ä½ï¼Œè¿™æ ·å°±åˆšå¥½æ˜¯å››ä¸ªintå€¼äº†ï¼Œæˆ‘ä»¬è¿™é‡Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºå°±ä¸åšè¿™æ ·çš„ä¼˜åŒ–äº†ã€‚
private struct DispatchParams { public int2 offset; public int count; public int stride; public int xMajor; public DispatchParams(int2 offset, int count, int stride, int xMajor) { this....</p></div><footer class=entry-footer><span title='2024-03-30 12:00:00 +0800 CST'>March 30, 2024</span>&nbsp;Â·&nbsp;zznewclear13</footer><a class=entry-link aria-label="post link to å¾„å‘åˆ†æ´¾Compute Shader" href=https://zznewclear13.github.io/posts/dispatch-compute-shader-in-a-radial-way/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://zznewclear13.github.io/posts/images/HexTiling.png alt="Hex Tiling Cover"></figure><header class=entry-header><h2 class=entry-hint-parent>åœ¨åœ°å½¢è´´å›¾æ··åˆæ—¶ä½¿ç”¨å…­è¾¹å½¢å¹³é“º</h2></header><div class=entry-content><p>åŠ¨æœº æœ€è¿‘çœ‹åˆ°äº†ä¸‰è§’æ´²è¡ŒåŠ¨ä»‹ç»çš„åœ¨è™šå¹»å¼•æ“4ä¸­å®ç°çš„åœ°å½¢æ¸²æŸ“æ–¹æ¡ˆï¼Œæ„Ÿè§‰å—ç›ŠåŒªæµ…ã€‚ä¸è¿‡åœ¨Unityä¸­è¦æƒ³å®ç°ä¸€ä¸ªå³æ’å³ç”¨çš„è™šæ‹Ÿè´´å›¾çš„æŠ€æœ¯åº”è¯¥æœ‰äº›å›°éš¾ï¼Œäºæ˜¯æˆ‘æŠŠç›®å…‰æ”¾åœ¨äº†æœ€ä¸€å¼€å§‹æ‰€ä»‹ç»çš„å¯¹åœ°å½¢è´´å›¾åšæ··åˆçš„æ–¹æ¡ˆä¸Šã€‚
ä¸‰è§’æ´²è¡ŒåŠ¨æå‡ºçš„æ–¹æ¡ˆæ˜¯è¿™æ ·çš„ï¼Œåœ¨åœ°å½¢è®¡ç®—çš„æ—¶å€™ï¼Œä»å¯¹æè´¨IDå›¾çš„å››ä¸ªåƒç´ é‡‡æ ·é€€åŒ–æˆå¯¹ä¸‰ä¸ªåƒç´ é‡‡æ ·ï¼Œè¿™æ ·ä¸€æ¥æ—¢èƒ½å‡å°‘åœ°å½¢æ··åˆçš„æ—¶å€™çš„é‡‡æ ·æ¬¡æ•°ï¼ŒäºŒæ¥ç›¸è¾ƒäºé‡‡æ ·å››ä¸ªåƒç´ ï¼Œä¸‰ä¸ªåƒç´ å¤šäº†ä¸€ä¸ªæ–œå‘45åº¦çš„æ•ˆæœï¼Œèƒ½å¤Ÿå‡è½»ä¸€äº›åœ°å½¢çš„å—é¢æ„Ÿã€‚ä¸è¿‡ä»–ä»¬ä¹Ÿæœ‰è¯­ç„‰ä¸è¯¦çš„åœ°æ–¹ï¼Œè™½ç„¶åªé‡‡æ ·ä¸‰ä¸ªåƒç´ èƒ½å¤Ÿæä¾›æ–œå‘45åº¦ï¼Œä½†æ˜¯å¯¹äºæ–œå‘-45åº¦ï¼Œä»…ä½¿ç”¨åŒä¸€ç§æ–¹å¼é‡‡æ ·ä¸‰ä¸ªåƒç´ æ˜¯ä¸èƒ½æ¶ˆé™¤è¿™ä¸ªæ–¹å‘çš„å—é¢æ„Ÿçš„ï¼Œå½“ç„¶æƒ³å¿…ä»–ä»¬ä¹Ÿæœ‰å¯¹åº”çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯äº†ã€‚æ­¤å¤–ä»–ä»¬å£°ç§°æè´¨IDå›¾æ˜¯ä¸€å¼ R8çš„è´´å›¾ï¼Œä½†è¿™å¼ è´´å›¾é‡Œé¢æ€ä¹ˆä¼šæœ‰5bitçš„ä¸‹å±‚IDï¼Œ5bitçš„ä¸Šå±‚IDï¼Œå†æœ‰3bitçš„æƒé‡å€¼å‘¢ï¼Ÿæˆ‘åªèƒ½è®¤ä¸ºè¿™å¼ æè´¨IDå›¾å®é™…ä¸ŠåªåŒ…å«äº†ä¸€ä¸ª5bitçš„æè´¨IDå’Œ3bitçš„æƒé‡äº†ï¼Œè¿™ä¸ª3bitçš„æƒé‡å€¼ä¼šåœ¨å’Œå¦å¤–å‡ ä¸ªåƒç´ æ··åˆæ—¶ä½¿ç”¨åˆ°ã€‚
ä¸è¿‡ä¸‰æ¬¡é‡‡æ ·å€’æ˜¯è®©æˆ‘æƒ³èµ·äº†Hex Tilingã€‚åœ¨Practical Real-Time Hex-Tilingé‡Œä»‹ç»äº†ä¸€ç§é€šè¿‡å…­è¾¹å½¢å¹³é“ºæ¥é™ä½å¹³é“ºæ—¶çº¹ç†é‡å¤æ„Ÿçš„ç®—æ³•ï¼Œè¿™ç§ç®—æ³•æ­£å·§éœ€è¦å¯¹ä¸»è´´å›¾é‡‡æ ·ä¸‰æ¬¡ï¼ˆä¸è€ƒè™‘éšæœºé‡‡æ ·çš„è¯ï¼‰ã€‚Githubä¸­ä¹Ÿèƒ½æ‰¾åˆ°å‚è€ƒçš„ä»£ç ã€‚
è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±èƒ½åœ¨ä¸‰è§’æ´²è¡ŒåŠ¨çš„æ–¹æ¡ˆä¸Šå†æå‡ºä¸€ç§æ–°çš„åœ°å½¢æ··åˆçš„æ–¹æ³•äº†ã€‚æˆ‘ä»¬åŒæ ·æ˜¯é‡‡æ ·ä¸‰ä¸ªåƒç´ ï¼Œä¸è¿‡æˆ‘ä»¬åœ¨åœ°å½¢ä¸­ä¼šå°†è¿™ä¸‰ä¸ªåƒç´ ç”¨ç­‰è¾¹ä¸‰è§’å½¢çš„æ–¹å¼æ’å¸ƒï¼Œè€Œä¸æ˜¯ç›®å‰æ‰€ç”¨çš„ç›´è§’ä¸‰è§’å½¢ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æµç¨‹æ˜¯ï¼Œå…ˆå°†å½“å‰çš„ä¸–ç•Œç©ºé—´æˆ–è€…uvåšä¸€æ¬¡ä¸‰è§’å½¢æ ¼ç‚¹çš„å˜æ¢ï¼Œä½¿ç”¨å˜æ¢åçš„æ ¼ç‚¹é‡‡æ ·æè´¨IDå›¾è·å¾—ä¸‰ä¸ªæè´¨IDå’Œæƒé‡ï¼Œå†ä½¿ç”¨è·å¾—çš„æ•°æ®å’Œæœ¬èº«çš„å…­è¾¹å½¢å¹³é“ºçš„æƒé‡è¿›è¡Œæ··åˆï¼Œå°±èƒ½å¾—åˆ°æˆ‘ä»¬æœ€ç»ˆçš„æ··åˆåçš„åœ°å½¢æè´¨äº†ã€‚å¦‚æœæŠŠæˆ‘ä»¬çš„æè´¨IDå›¾å¹³é“ºåˆ°ä¸–ç•Œç©ºé—´ï¼Œçœ‹ä¸Šå»åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š
ç”Ÿæˆæè´¨IDå›¾ ä¸ºäº†å¿«é€Ÿç”Ÿæˆæè´¨IDå›¾ï¼ˆæˆ‘å¯ä¸æƒ³æ‰‹ç”»ï¼‰ï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨Compute Shaderé€šè¿‡Perlin Noiseç”Ÿæˆæè´¨IDï¼Œä½¿ç”¨æ™®é€šçš„hashç”Ÿæˆæƒé‡ã€‚ä¸ºäº†ä½¿æˆ‘ä»¬çš„æè´¨IDå›¾ä¹Ÿèƒ½æ­£å¸¸çš„å¹³é“ºï¼Œæˆ‘ä»¬åœ¨è®¡ç®—Perlin Noiseçš„æ—¶å€™ï¼Œè¦æ³¨æ„ä½¿ç”¨å–æ¨¡çš„è¿ç®—å°†è®¡ç®—çš„uvå€¼é™åˆ¶åœ¨åŒä¸€ä¸ªèŒƒå›´å†…ã€‚
æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ª8bitçš„æ•°æ®ï¼Œä½†æ˜¯ç”±äºUnityä¿å­˜è´´å›¾çš„ç§ç§é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†R8_Uintçš„æ•°æ®é™¤ä»¥255è½¬æ¢æˆR8_UNormç±»å‹çš„æ•°æ®å†å‚¨å­˜åˆ°è´´å›¾ä¸­ã€‚
GenerateMatIDComputeShader.compute #pragma kernel MatIDGenMain RWTexture2D&lt;float> _RW_MatIDTex; float4 _TextureSize; // https://www.shadertoy.com/view/4djSRW float hash12(float2 p) { float3 p3 = frac(float3(p.xyx) * .1031); p3 += dot(p3, p3.yzx + 33.33); return frac((p3.x + p3.y) * p3.z); } float2 repeat(float2 coord, float2 size, float2 offset) { return coord - floor(coord / size) * size + offset; } float encode(int weight, int index) { int encoded = (weight &lt;&lt; 5) | index; return float(encoded) / 255....</p></div><footer class=entry-footer><span title='2024-03-19 12:00:00 +0800 CST'>March 19, 2024</span>&nbsp;Â·&nbsp;zznewclear13</footer><a class=entry-link aria-label="post link to åœ¨åœ°å½¢è´´å›¾æ··åˆæ—¶ä½¿ç”¨å…­è¾¹å½¢å¹³é“º" href=https://zznewclear13.github.io/posts/use-hex-tiling-for-terrain-texture-blending/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://zznewclear13.github.io/categories/unity/page/2/>Next&nbsp;&nbsp;Â»</a></nav></footer><div style=display:none>zznewclear13 æŠ€æœ¯ç¾æœ¯ å›¾å½¢å­¦ ä¸ªäººåšå®¢ technical art computer graphics</div></main><footer class=footer><span>&copy; 2024 <a href=https://zznewclear13.github.io/>ZZNEWCLEAR13</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>