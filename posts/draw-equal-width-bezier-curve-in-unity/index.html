<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿ | ZZNEWCLEAR13</title>
<meta name=keywords content="Anti-Aliasing,Bezier Curve,Signed Distance Field"><meta name=description content="åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿ï¼Œå¯å®æ—¶æ§åˆ¶é•¿å®½ã€å¼¯æ›²ç¨‹åº¦å’Œé˜´å½±ç­‰å‚æ•°."><meta name=author content="zznewclear13"><link rel=canonical href=https://zznewclear13.github.io/posts/draw-equal-width-bezier-curve-in-unity/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://zznewclear13.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zznewclear13.github.io/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://zznewclear13.github.io/favicon.ico><link rel=apple-touch-icon href=https://zznewclear13.github.io/favicon.ico><link rel=mask-icon href=https://zznewclear13.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://zznewclear13.github.io/posts/draw-equal-width-bezier-curve-in-unity/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css integrity=sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js integrity=sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JZ0FQH1VK5"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JZ0FQH1VK5")}</script><meta property="og:title" content="åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿"><meta property="og:description" content="åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿ï¼Œå¯å®æ—¶æ§åˆ¶é•¿å®½ã€å¼¯æ›²ç¨‹åº¦å’Œé˜´å½±ç­‰å‚æ•°."><meta property="og:type" content="article"><meta property="og:url" content="https://zznewclear13.github.io/posts/draw-equal-width-bezier-curve-in-unity/"><meta property="og:image" content="https://zznewclear13.github.io/posts/draw-equal-width-bezier-curve-in-unity/posts/images/EqualWidthBezierCurve.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-15T12:00:00+08:00"><meta property="article:modified_time" content="2021-12-15T12:00:00+08:00"><meta property="og:site_name" content="ZZNEWCLEAR13"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zznewclear13.github.io/posts/draw-equal-width-bezier-curve-in-unity/posts/images/EqualWidthBezierCurve.jpg"><meta name=twitter:title content="åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿"><meta name=twitter:description content="åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿ï¼Œå¯å®æ—¶æ§åˆ¶é•¿å®½ã€å¼¯æ›²ç¨‹åº¦å’Œé˜´å½±ç­‰å‚æ•°."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://zznewclear13.github.io/posts/"},{"@type":"ListItem","position":2,"name":"åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿","item":"https://zznewclear13.github.io/posts/draw-equal-width-bezier-curve-in-unity/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿","name":"åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿","description":"åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿ï¼Œå¯å®æ—¶æ§åˆ¶é•¿å®½ã€å¼¯æ›²ç¨‹åº¦å’Œé˜´å½±ç­‰å‚æ•°.","keywords":["Anti-Aliasing","Bezier Curve","Signed Distance Field"],"articleBody":"åŠ¨æœºå’Œè´å¡å°”æ›²çº¿ç›¸å…³çš„èƒŒæ™¯çŸ¥è¯† åŠ¨æœºå½“ç„¶æ˜¯è¦åœ¨UIä¸Šç»˜åˆ¶ä¸€ä¸ªè´å¡å°”æ›²çº¿çš„å½¢çŠ¶äº†ï¼Œæƒ³åšçš„æ•ˆæœå¤§æ¦‚å°±å’Œè™šå¹»å¼•æ“è“å›¾è¿æ¥èŠ‚ç‚¹çš„çº¿å·®ä¸å¤šäº†ã€‚è¿™é‡Œè¦ç»˜åˆ¶çš„æ˜¯ä¸€ç§è¾ƒä¸ºç‰¹æ®Šçš„è´å¡å°”æ›²çº¿ï¼Œå®ƒçš„ä¸¤ä¸ªç«¯ç‚¹çš„åˆ‡çº¿æ˜¯æ°´å¹³çš„ï¼Œä¸”æ‹¥æœ‰æ—‹è½¬å¯¹ç§°çš„ç‰¹æ€§ã€‚\næˆ‘ä»¬æƒ³è¦ç»˜åˆ¶çš„Så½¢æ›²çº¿æ˜¯ä¸‰é˜¶çš„è´å¡å°”æ›²çº¿ã€‚ä¸‰é˜¶è´å¡å°”æ›²çº¿æœ‰å››ä¸ªæ§åˆ¶ç‚¹\\(P_0, P_1, P_2, P_3\\)ï¼Œå¯¹äºä¸€ä¸ªä»0åˆ°1çš„å˜é‡\\(t\\)ï¼Œè´å¡å°”æ›²çº¿çš„åšæ³•æ˜¯å¯¹è¿™å››ä¸ªç‚¹æŒ‰ç…§é¡ºåºä»¥\\(t\\)åšæ’å€¼ç”Ÿæˆä¸‰ä¸ªæ–°çš„ç‚¹ï¼Œç„¶åå¯¹è¿™ä¸‰ä¸ªç‚¹æŒ‰ç…§é¡ºåºä»¥\\(t\\)åšæ’å€¼ç”Ÿæˆæ–°çš„ä¸¤ä¸ªç‚¹ï¼Œå†å¯¹è¿™ä¸¤ä¸ªç‚¹ä»¥tåšæ’å€¼ç”Ÿæˆæœ€åçš„ç‚¹ï¼Œå½“tåœ¨0åˆ°1ä¸­å˜åŒ–æ—¶ï¼Œè¿™ä¸ªç‚¹çš„è½¨è¿¹å°±æ„æˆäº†è´å¡å°”æ›²çº¿ã€‚è´å¡å°”æ›²çº¿ä¸Šçš„ç‚¹å¯ä»¥ç”¨å››ä¸ªæ§åˆ¶ç‚¹å’Œ\\(t\\)æ¥è¡¨ç¤ºï¼š $$ P_{bezier} = P_0 \\cdot (1 - t)^3 + 3 P_1 \\cdot (1 - t)^2 \\cdot t + 3 P_2 \\cdot (1 - t) \\cdot t^2 + P_3 \\cdot t^3 $$\nå¦‚æœåˆå§‹å››ä¸ªç‚¹åˆ†åˆ«æ˜¯(0.0, 1.0), (d, 1.0), (1.0 - d, 0.0)ï¼Œå’Œ(1.0, 0.0)çš„è¯ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¦ç»˜åˆ¶çš„ç‰¹æ®Šçš„è´å¡å°”æ›²çº¿ï¼Œå¯ä»¥ç®—å‡ºè´å¡å°”æ›²çº¿çš„åæ ‡ä¸º $$ P_{bezier} = ((3 t - 9t ^ 2 + 6t^3) \\cdot d + 3t^2 - 2t^3, 1 - 3t^2 + 2t^3) $$ ä½†æ˜¯å³ä½¿å¾—åˆ°äº†è´å¡å°”æ›²çº¿çš„å‚æ•°æ–¹ç¨‹ï¼Œæƒ³è¦å°†å…¶è¡¨è¾¾æˆ\\(f(x)\\)çš„å½¢å¼ä»ç„¶æ˜¯ç›¸å½“å›°éš¾çš„ã€‚Alan Wolfeåœ¨ä»–çš„åšå®¢ä¸­æåˆ°äº†ä¸€ç§ä¸€ç»´è´å¡å°”æ›²çº¿ï¼Œä¹Ÿæ˜¯ä¸€ç§è´å¡å°”æ›²çº¿çš„ç‰¹æ®Šæƒ…å†µï¼Œå››ä¸ªæ§åˆ¶ç‚¹åœ¨æ°´å¹³æ–¹å‘ä¸Šç­‰è·æ’å¼€ï¼Œè¿™æ ·å­è´å¡å°”æ›²çº¿çš„å‚æ•°æ–¹ç¨‹çš„æ°´å¹³åˆ†é‡å°±åˆšå¥½æ˜¯\\(t\\)ï¼Œå®ƒçš„ç«–ç›´åˆ†é‡ä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„\\(f(x)\\)ã€‚å”¯ä¸€ç¾ä¸­ä¸è¶³çš„æ˜¯ï¼Œèƒ½è½»æ˜“å¾—åˆ°\\(f(x)\\)çš„ä¸€ç»´è´èµ›å°”æ›²çº¿ï¼Œå¾€å¾€æ˜¯ä¸€ä¸ªâ€œèººå€’â€çš„è´èµ›å°”æ›²çº¿ï¼Œæ„Ÿå®˜ä¸Šçœ‹ä¸Šå»æ˜¯æ¨ªç€çš„ï¼ŒShadertoyä¸Šæœ‰ç›¸å…³çš„æ¼”ç¤ºã€‚ä½†è¿™ç§ä¸€ç»´è´å¡å°”æ›²çº¿åˆæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œä¹Ÿå°±æ˜¯å‰ä¸¤ä¸ªæ§åˆ¶ç‚¹çš„ç«–ç›´é«˜åº¦ç›¸ç­‰ï¼Œåä¸¤ä¸ªæ§åˆ¶ç‚¹çš„ç«–ç›´é«˜åº¦ä¹Ÿç›¸ç­‰ï¼Œè¿™æ—¶è¿™ç§ç‰¹æ®Šçš„ä¸€ç»´è´å¡å°”æ›²çº¿å°±æ˜¯æˆ‘ä»¬è€³ç†Ÿèƒ½è¯¦çš„smoothstepæ›²çº¿äº†ï¼ˆæ•°å­¦çœŸå¥‡å¦™å•Šï¼‰ã€‚å¯æƒœsmoothstepä¸èƒ½æ»¡è¶³æˆ‘ä»¬éšæ„æ§åˆ¶æ›²çº¿å½¢çŠ¶çš„éœ€æ±‚ï¼Œåªèƒ½å¦æ±‚ä»–æ³•ã€‚\näº‹å®ä¸Šæˆ‘ä»¬æƒ³è¦ç¡®ä¿ç»˜åˆ¶å‡ºçš„è´å¡å°”æ›²çº¿æ˜¯ç­‰å®½çš„ï¼Œä¹Ÿä¸èƒ½åªä½¿ç”¨æ›²çº¿çš„\\(f(x)\\)ï¼Œè¿™æ ·åªèƒ½ç¡®ä¿å…¶åœ¨ç«–ç›´æ–¹å‘æ˜¯ç­‰å®½çš„ã€‚éœ€è¦æ•´ä½“ç­‰å®½ï¼Œç­‰ä»·äºéœ€è¦çŸ¥é“å¹³é¢ä¸Šæ¯ä¸€ä¸ªç‚¹åˆ°è´å¡å°”æ›²çº¿çš„æœ€è¿‘è·ç¦»ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡çš„è·ç¦»åœºDistance Fieldäº†ã€‚è¦æ±‚ä»»æ„è´å¡å°”æ›²çº¿çš„è·ç¦»åœºï¼Œä¸æ˜¯ä¸€ä¸ªç‰¹åˆ«ç®€å•çš„äº‹æƒ…ï¼Œéœ€è¦ç‰›é¡¿è¿­ä»£æ³•ç­‰æ•°å­¦æ–¹æ³•ï¼Œä½†æ˜¯å¥½åœ¨Shadertoyä¸Šçš„ç”¨æˆ·NinjaKoalaå·²ç»å¸®æˆ‘ä»¬æŠŠè¿™ä¸ªé—®é¢˜è§£å†³äº†ï¼Œè€Œä¸”æ— ç§çš„æŠŠæºä»£ç åˆ†äº«ç»™äº†æˆ‘ä»¬ã€‚æœ¬åšå®¢ä¸­ä½¿ç”¨çš„è·ç¦»åœºæ˜¯NinjaKoalaç»™å‡ºçš„ä¸€ç§å¤§è‡´çš„è·ç¦»åœºï¼Œåœ¨è·ç¦»è´å¡å°”æ›²çº¿è¾ƒè¿œæ—¶ä¼šæœ‰ä¸€äº›åå·®ï¼Œä½†è¾ƒè¿‘çš„è·ç¦»åŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆé—®é¢˜ã€‚\nä¸€äº›å…¶ä»–çš„éœ€æ±‚ å·²ç»åŸºæœ¬çŸ¥é“è¯¥æ€ä¹ˆç»˜åˆ¶è´å¡å°”æ›²çº¿äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘åˆ°åœ¨ä½¿ç”¨Shaderæ—¶å€™çš„ä¸€äº›éœ€æ±‚ã€‚æˆ‘ä»¬è¦è€ƒè™‘çš„ä¸ä»…ä»…æ˜¯è°ƒæ•´é¢œè‰²ã€å®½åº¦ã€é˜´å½±ç­‰å‚æ•°ï¼Œè€Œæ˜¯è¿™ä¸ªShaderå°†è¦å¦‚ä½•æ”¾åˆ°å±å¹•ä¸Šã€‚\næ­£å¸¸æ¥è¯´ç­–åˆ’ä¼šæŒ‡å®šä¸¤ä¸ªé¡¶ç‚¹ï¼Œè¯´åœ¨è¿™ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´ç”»ä¸€æ¡è´èµ›å°”æ›²çº¿ï¼Œè¿™æ—¶ç¨‹åºä¼šç»™æˆ‘ä»¬ä¸¤ä¸ªå±å¹•ç©ºé—´åæ ‡ï¼ˆåœ¨Unityä¸­å°±æ˜¯RectTransformçš„åæ ‡äº†ï¼‰ï¼Œæ ¹æ®è¿™ä¸¤ä¸ªåæ ‡ä½¿ç”¨Imageè¿™ä¸ªç»„ä»¶ï¼Œåœ¨å±å¹•ä¸Šç”¨æˆ‘ä»¬å†™çš„Shaderçš„æè´¨æ¸²æŸ“ä¸€ä¸ªQuadã€‚\nä½†æ˜¯äº‹æƒ…å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼ŒQuadçš„é¡¶ç‚¹æ˜¯è´å¡å°”æ›²çº¿çš„ä¸¤ä¸ªç«¯ç‚¹çš„è¯ï¼Œä¸€ä¸ªç­‰å®½çš„è´èµ›å°”æ›²çº¿å°±ä¼šè¶…å‡ºQuadçš„èŒƒå›´ï¼Œæ›´ä¸è¦è¯´è¿˜æœ‰ä¸€æ®µåç§»å’Œæ¨¡ç³Šçš„é˜´å½±äº†ã€‚å› æ­¤æˆ‘ä»¬è¦åšæ˜¯åœ¨ç»˜åˆ¶ç»™å®šå››ä¸ªé¡¶ç‚¹çš„Quadæ—¶ï¼Œåœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å°†å…¶é¡¶ç‚¹å‘å¤–åç§»ä¸€å®šçš„æ•°é‡ï¼Œè®©æ•´æ¡è´å¡å°”æ›²çº¿å’Œå…¶é˜´å½±éƒ½èƒ½è½åœ¨æ‰©å¤§åçš„Quadçš„èŒƒå›´ä¸­ã€‚\nå€¼å¾—ä¸€æçš„æ˜¯ï¼Œæœ¬æ¥æ¶ˆè€—å¾ˆé«˜çš„è½¯é˜´å½±ï¼ˆéœ€è¦å¾ˆå¤šæ¬¡é‡‡æ ·ï¼‰ï¼Œåœ¨è·å¾—äº†è·ç¦»åœºä¹‹åï¼Œå¯ä»¥é€šè¿‡æ™®é€šçš„lerpæˆ–è€…Smoothstepç›´æ¥ç”Ÿæˆï¼Œä¹Ÿæ˜¯å¯å–œå¯è´ºçš„ä¸€ä»¶äº‹ã€‚\nå…·ä½“çš„å®æ–½æ­¥éª¤ åœ¨Canvasä¸­åˆ›å»ºä¸€ä¸ªImageç»„ä»¶ï¼ŒæŒ‚ä¸Šæˆ‘ä»¬çš„æè´¨çƒå’ŒDrawBezierCurveè„šæœ¬ã€‚ åœ¨DrawBezierCurveè„šæœ¬ä¸­è·å–Imageç»„ä»¶çš„åƒç´ å•ä½çš„å®½å’Œé«˜ï¼ˆå…¶å®åªè¦é«˜å°±è¡Œäº†ï¼‰ï¼Œå°†è¿™ä¸ªå€¼ä¼ ç»™Shaderã€‚ é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼Œé¦–å…ˆéœ€è¦å°†Quadä¸Šæ–¹çš„ä¸¤ä¸ªé¡¶ç‚¹å¾€ä¸Šç§»åŠä¸ªè´å¡å°”æ›²çº¿çš„å®½åº¦ä¸ªåƒç´ heightA = _Width * 0.5ï¼Œç„¶åè¦å°†Quadä¸‹æ–¹çš„ä¸¤ä¸ªé¡¶ç‚¹å¾€ä¸‹ç§»é˜´å½±åç§»åŠ åŠä¸ªé˜´å½±å®½åº¦ä¸ªåƒç´ heightC = _ShadowOffset + _ShadowWidth * 0.5ã€‚åœ¨uvçš„æ—¶å€™è¦ç¡®ä¿åç§»ä¹‹åçš„uvåœ¨åŸQuadèŒƒå›´å†…ä»æ˜¯0-1ä¹‹é—´çš„ã€‚è¿™ä¸€æ­¥å¯¹æœ€ç»ˆçš„æ•ˆæœè‡³å…³é‡è¦ï¼ ç‰‡å…ƒç€è‰²å™¨ä¸­ï¼Œä½¿ç”¨ddx(uv.x)å’Œddy(uv.y)ï¼Œå¯ä»¥è®¡ç®—å‡ºè´å¡å°”æ›²çº¿çš„ä»¥åƒç´ ä¸ºå•ä½çš„è·ç¦»åœºï¼ˆä¹Ÿèƒ½ç”¨C#è„šæœ¬ä¼ å…¥çš„Quadçš„é«˜å’Œå®½æ¥ç®—ï¼Œä¸è¿‡åº”è¯¥æ˜¯ddxæ¯”è¾ƒæ–¹ä¾¿ï¼‰ã€‚ä½¿ç”¨smoothstepå°±èƒ½ç»˜åˆ¶å‡ºæŠ—é”¯é½¿çš„è´å¡å°”æ›²çº¿ï¼Œæˆ–æ˜¯æ¨¡ç³Šçš„é˜´å½±äº†ã€‚ DrawBezierCurve.cs Updateçš„æ—¶å€™è¦è®°å¾—æ‹¿åˆ°å¯¹åº”çš„æè´¨çš„å¼•ç”¨ã€‚\nusing UnityEngine; using UnityEngine.UI; [ExecuteInEditMode] [RequireComponent(typeof(Image))] [RequireComponent(typeof(RectTransform))] public class DrawBezierCurve : MonoBehaviour { public Image image; public RectTransform rectTransform; private Material material; private void OnEnable() { image = GetComponent(); material = new Material(image.material); image.material = material; rectTransform = GetComponent(); } private void Update() { Vector2 bottomLeftCorner = rectTransform.anchoredPosition + rectTransform.rect.min; Vector2 topRightCorner = rectTransform.anchoredPosition + rectTransform.rect.max; Vector4 anchorPos = new Vector4(bottomLeftCorner.x, bottomLeftCorner.y, topRightCorner.x, topRightCorner.y); material.SetVector(\"_AnchorPos\", anchorPos); } } BezierShader.shader è´å¡å°”çš„è·ç¦»åœºæ¥è‡ªCubic bezier approx distance 2ã€‚\næˆ‘è¿˜å¢åŠ äº†é€‰é¡¹ï¼Œåœ¨æ˜¾ç¤ºä¸€æ¡æ¨ªçº¿æ—¶å…³é—­BEZIERCURVEå°±èƒ½ä½¿ç”¨æ•ˆç‡æ›´é«˜çš„æ¨ªçº¿çš„è·ç¦»åœºäº†ï¼ˆè¦æ³¨æ„ç»˜åˆ¶æ¨ªçº¿æ—¶ï¼ŒRectTransformä¸­Heightçš„å€¼ä¸èƒ½è®¾ç½®æˆ0ï¼Œæœ€å¥½è®¾ç½®æˆä¸€ä¸ªå¦‚0.01çš„å°æ•°ï¼‰ï¼ŒåŒæ—¶ä¹Ÿæ·»åŠ äº†æ°´å¹³ç¿»è½¬çš„é€‰é¡¹ã€‚\nè´å¡å°”æ›²çº¿å’Œé˜´å½±æ··åˆä¹‹åå†å‚åŠ é€æ˜åº¦æ··åˆï¼Œä¼šç»™è´å¡å°”æ›²çº¿å¸¦ä¸Šä¸€æ¡æµ…æµ…çš„é˜´å½±é¢œè‰²çš„æè¾¹ï¼Œæ•ˆæœè¿˜ç®—ä¸é”™ï¼Œè¿™é‡Œå°±æš‚æ—¶ä¸ä¿®æ”¹äº†ã€‚ä½†æ˜¯å¦‚æœä¸æƒ³è¦è¿™ä¸ªæè¾¹çš„è¯ã€‚éœ€è¦é¢„å…ˆè®¡ç®—å‡ºæ··åˆåçš„é¢œè‰²å€¼å’Œé€æ˜åº¦å€¼ã€‚å¦‚æœç”¨\\((c_1, a_1)\\)ã€\\((c_2, a_2)\\)ã€\\((c_0)\\)æ¥åˆ†åˆ«è¡¨ç¤ºæ›²çº¿å’Œé˜´å½±çš„é¢œè‰²å€¼ã€é€æ˜åº¦å€¼å’Œé€æ˜åº¦æ··åˆæ—¶ç›®æ ‡çš„é¢œè‰²çš„è¯ï¼ˆä»å‰å¾€åçš„é¡ºåºåº”è¯¥æ˜¯æ›²çº¿\\((c_1, a_1)\\)ï¼Œé˜´å½±\\((c_2, a_2)\\)å’Œé€æ˜åº¦æ··åˆç›®æ ‡\\((c_0)\\)ï¼‰ï¼Œæ­£ç¡®çš„é€æ˜åº¦æ··åˆçš„é¢œè‰²åº”è¯¥æ˜¯\\(c_1 a_1 + c_2 a_2 (1 - a_1) + c_0 (1 - a_1) (1 - a_2)\\)ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®é€æ˜åº¦æ··åˆæ¨¡å¼ä¸ºBlend One SrcAlphaï¼Œç„¶åå°†è¾“å‡ºçš„é¢œè‰²è®¾ç½®æˆfloat4(c1 * a1 + c2 * a2 * (1 - a1), (1 - a1) * (1 - a2))ï¼Œè¿™æ ·æ··åˆåçš„é¢œè‰²å°±æ˜¯å®Œç¾çš„æ­£å¸¸çš„é€æ˜åº¦æ··åˆäº†ã€‚\n//Based on https://www.shadertoy.com/view/3lsSzS Shader \"zznewclear13/BezierShader\" { Properties { [HideInInspector] _MainTex (\"Main Texture\", 2D) = \"white\" {} [Header(Marcos)] [Toggle(BEZIERCURVE)] _BezierCurve(\"Bezier Curve\", float) = 1 [Toggle(FLIP)] _Flip (\"Flip\", float) = 0 [Header(Curve Settings)] _Color (\"Color\", Color) = (1.0, 1.0, 1.0, 1.0) _Curve (\"Curve\", range(0, 1)) = 0.2 _Width (\"Pixel Width\", float) = 5 [Header(Shadow Settings)] _ShadowColor (\"Shadow Color\", color) = (0.0, 0.0, 0.0, 0.5) _ShadowOffset (\"Shadow Offset\", float) = 30 _ShadowWidth (\"Shadow Width\", float) = 20 } HLSLINCLUDE #include \"Packages/com.unity.render-pipelines.core/ShaderLibrary/Common.hlsl\" #include \"Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl\" #pragma multi_compile_local _ FLIP #pragma multi_compile_local _ BEZIERCURVE sampler2D _MainTex; CBUFFER_START(UnityPerMaterial) float4 _Color; float _Curve; float _Width; float4 _ShadowColor; float _ShadowOffset; float _ShadowWidth; CBUFFER_END float4 _AnchorPos; static float2 VertexOffsets[] = { float2(0, -1), float2(1, 0), float2(1, 0), float2(0, -1), }; struct Attributes { uint vertexID : SV_VERTEXID; float4 positionOS : POSITION; float2 texcoord : TEXCOORD0; }; struct Varyings { float4 positionCS : SV_POSITION; float2 uv : TEXCOORD0; }; Varyings Vert(Attributes input) { Varyings output = (Varyings)0; float4 positionOS = input.positionOS; float heightA = _Width * 0.5; float heightB = _AnchorPos.w - _AnchorPos.y; float heightC = _ShadowOffset + _ShadowWidth * 0.5; positionOS.y += VertexOffsets[input.vertexID].x * heightA + VertexOffsets[input.vertexID].y * heightC; VertexPositionInputs vertexInput = GetVertexPositionInputs(positionOS); output.positionCS = vertexInput.positionCS; //0-1 -\u003e -(heightC) / heightB, (heightA + heightB + heightC) / heightB float newCoordY = (heightA + heightB + heightC) / heightB * input.texcoord.y - (heightC) / heightB ; output.uv = float2(input.texcoord.x, newCoordY); return output; } float cubic_bezier_normal_iteration(float t, float2 a0, float2 a1, float2 a2, float2 a3) { //factor should be positive //it decreases the step size when lowered. //Lowering the factor and increasing iterations increases the area in which //the iteration converges, but this is quite costly const float factor=1.; //horner's method float2 a_2=a2+t*a3; float2 a_1=a1+t*a_2; float2 b_2=a_2+t*a3; float2 uv_to_p=a0+t*a_1; float2 tang=a_1+t*b_2; float l_tang=dot(tang,tang); return t-factor*dot(tang,uv_to_p)/l_tang; } float cubic_bezier_dis_approx_sq(float2 uv, float2 p0, float2 p1, float2 p2, float2 p3) { float2 a3 = (-p0 + 3. * p1 - 3. * p2 + p3); float2 a2 = (3. * p0 - 6. * p1 + 3. * p2); float2 a1 = (-3. * p0 + 3. * p1); float2 a0 = p0 - uv; float d0 = 1e38; float t0=0.; float t; const int num_iterations=3; const int num_start_params=3; for(int i=0;i\u003cnum_start_params;i++) { t=t0; for(int j=0;j\u003cnum_iterations;j++) { t=cubic_bezier_normal_iteration(t,a0,a1,a2,a3); } t=clamp(t,0.,1.); float2 uv_to_p=((a3*t+a2)*t+a1)*t+a0; d0=min(d0,dot(uv_to_p,uv_to_p)); t0+=1./float(num_start_params-1); } return d0; } float cubic_bezier_dis_approx(float2 uv, float2 p0, float2 p1, float2 p2, float2 p3) { return sqrt(cubic_bezier_dis_approx_sq(uv,p0,p1,p2,p3)); } float4 Frag(Varyings input) : SV_TARGET { float ddxX = ddx(input.uv.x); float ddyY = ddy(input.uv.y); float2 scale = float2(rcp(ddxX), rcp(ddyY)); float2 coord = input.uv; #if FLIP coord.x = 1.0 - coord.x; #endif #if BEZIERCURVE float2 p0=float2(0.0, 1.0) * scale; float2 p1=float2(_Curve, 1.0) * scale; float2 p2=float2(1.0 - _Curve, 0.0) * scale; float2 p3=float2(1.0, 0.0) * scale; float dist = cubic_bezier_dis_approx(coord * scale,p0,p1,p2,p3); float widthVal = _Width * 0.5; float alpha = smoothstep(widthVal + 1.0, widthVal, dist); float shadowDist = cubic_bezier_dis_approx(coord * scale + float2(0.0, _ShadowOffset),p0,p1,p2,p3); float shadowWidthVal = _ShadowWidth * 0.5; float shadowAlpha = smoothstep(shadowWidthVal + 1.0, 0.0, shadowDist); #else float dist = abs((1.0 - coord.y) * scale.y); float widthVal = _Width * 0.5; float alpha = smoothstep(widthVal + 1.0, widthVal, dist); float shadowDist = abs((1.0 - coord.y) * scale.y - _ShadowOffset); float shadowWidthVal = _ShadowWidth * 0.5; float shadowAlpha = smoothstep(shadowWidthVal + 1.0, 0.0, shadowDist); #endif float3 color = lerp(_ShadowColor.rgb, _Color.rgb, alpha * _Color.a); float finalAlpha = max(alpha * _Color.a, shadowAlpha * _ShadowColor.a); float4 returnColor = float4(color, finalAlpha); //returnColor = float4(input.uv, 0.0, 1.0); return returnColor; } ENDHLSL SubShader { Tags{ \"Queue\" = \"Transparent\" \"RenderType\" = \"Transparent\" } pass { Cull Back ZTest LEqual ZWrite Off Blend SrcAlpha OneMinusSrcAlpha HLSLPROGRAM #pragma vertex Vert #pragma fragment Frag ENDHLSL } } } æœ€åçš„æ€è€ƒ æ•°å­¦çœŸå¥‡å¦™å•Šï¼ä¹Ÿå¾ˆæ„Ÿè°¢Shadertoyä¸Šç”¨æˆ·ä»¬çš„æ— ç§çš„å¥‰çŒ®ï¼ä½†æ˜¯å¾®ç§¯åˆ†å¯¹æˆ‘æ¥è¯´è¿˜æ˜¯å¤ªéš¾äº†ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥æ‰¾ä¸ªæœºä¼šè¡¥ä¸€è¡¥å‘¢ã€‚ã€‚ã€‚æœ€åå°±æ˜¯æˆ‘æ„Ÿè§‰å¯¹fwidthæŠ—é”¯é½¿çš„ç†è§£åˆåŠ æ·±äº†ï¼\n","wordCount":"817","inLanguage":"en","image":"https://zznewclear13.github.io/posts/draw-equal-width-bezier-curve-in-unity/posts/images/EqualWidthBezierCurve.jpg","datePublished":"2021-12-15T12:00:00+08:00","dateModified":"2021-12-15T12:00:00+08:00","author":{"@type":"Person","name":"zznewclear13"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zznewclear13.github.io/posts/draw-equal-width-bezier-curve-in-unity/"},"publisher":{"@type":"Organization","name":"ZZNEWCLEAR13","logo":{"@type":"ImageObject","url":"https://zznewclear13.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zznewclear13.github.io/ accesskey=h title="ZZNEWCLEAR13 (Alt + H)"><img src=https://zznewclear13.github.io/apple-touch-icon.png alt aria-label=logo height=35>ZZNEWCLEAR13</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://zznewclear13.github.io/now/ title=è¿›è¡Œæ—¶><span>è¿›è¡Œæ—¶</span></a></li><li><a href=https://zznewclear13.github.io/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://zznewclear13.github.io/categories/ title=åˆ†ç±»><span>åˆ†ç±»</span></a></li><li><a href=https://zznewclear13.github.io/links/ title=å‹æƒ…é“¾æ¥><span>å‹æƒ…é“¾æ¥</span></a></li><li><a href=https://zznewclear13.github.io/search/ title="ğŸ” (Alt + /)" accesskey=/><span>ğŸ”</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zznewclear13.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://zznewclear13.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿</h1><div class=post-description>åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿ï¼Œå¯å®æ—¶æ§åˆ¶é•¿å®½ã€å¼¯æ›²ç¨‹åº¦å’Œé˜´å½±ç­‰å‚æ•°.</div><div class=post-meta><span title='2021-12-15 12:00:00 +0800 CST'>December 15, 2021</span>&nbsp;Â·&nbsp;zznewclear13&nbsp;|&nbsp;<a href=https://github.com/zznewclear13/zznewclear13.com/blob/main/content/posts/draw-equal-width-bezier-curve-in-unity.md rel="noopener noreferrer" target=_blank>ç¼–è¾‘</a></div></header><figure class=entry-cover><img loading=eager src=https://zznewclear13.github.io/posts/images/EqualWidthBezierCurve.jpg alt="Equal Width Bezier Curve"><p>å¸¦é˜´å½±çš„å¯æ§åˆ¶å„ç§å‚æ•°çš„ç­‰å®½çš„è´å¡å°”æ›²çº¿</p></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><div class=details>åœ¨Unityçš„UIä¸­ç»˜åˆ¶ç­‰å®½çš„è´èµ›å°”æ›²çº¿</div></summary><div class=inner><ul><li><a href=#%e5%8a%a8%e6%9c%ba%e5%92%8c%e8%b4%9d%e5%a1%9e%e5%b0%94%e6%9b%b2%e7%ba%bf%e7%9b%b8%e5%85%b3%e7%9a%84%e8%83%8c%e6%99%af%e7%9f%a5%e8%af%86 aria-label=åŠ¨æœºå’Œè´å¡å°”æ›²çº¿ç›¸å…³çš„èƒŒæ™¯çŸ¥è¯†>åŠ¨æœºå’Œè´å¡å°”æ›²çº¿ç›¸å…³çš„èƒŒæ™¯çŸ¥è¯†</a></li><li><a href=#%e4%b8%80%e4%ba%9b%e5%85%b6%e4%bb%96%e7%9a%84%e9%9c%80%e6%b1%82 aria-label=ä¸€äº›å…¶ä»–çš„éœ€æ±‚>ä¸€äº›å…¶ä»–çš„éœ€æ±‚</a></li><li><a href=#%e5%85%b7%e4%bd%93%e7%9a%84%e5%ae%9e%e6%96%bd%e6%ad%a5%e9%aa%a4 aria-label=å…·ä½“çš„å®æ–½æ­¥éª¤>å…·ä½“çš„å®æ–½æ­¥éª¤</a><ul><li><a href=#drawbeziercurvecs aria-label=DrawBezierCurve.cs>DrawBezierCurve.cs</a></li><li><a href=#beziershadershader aria-label=BezierShader.shader>BezierShader.shader</a></li></ul></li><li><a href=#%e6%9c%80%e5%90%8e%e7%9a%84%e6%80%9d%e8%80%83 aria-label=æœ€åçš„æ€è€ƒ>æœ€åçš„æ€è€ƒ</a></li></ul></div></details></div><div class=post-content><h2 id=åŠ¨æœºå’Œè´å¡å°”æ›²çº¿ç›¸å…³çš„èƒŒæ™¯çŸ¥è¯†>åŠ¨æœºå’Œè´å¡å°”æ›²çº¿ç›¸å…³çš„èƒŒæ™¯çŸ¥è¯†<a hidden class=anchor aria-hidden=true href=#åŠ¨æœºå’Œè´å¡å°”æ›²çº¿ç›¸å…³çš„èƒŒæ™¯çŸ¥è¯†>#</a></h2><p>åŠ¨æœºå½“ç„¶æ˜¯è¦åœ¨UIä¸Šç»˜åˆ¶ä¸€ä¸ªè´å¡å°”æ›²çº¿çš„å½¢çŠ¶äº†ï¼Œæƒ³åšçš„æ•ˆæœå¤§æ¦‚å°±å’Œè™šå¹»å¼•æ“è“å›¾è¿æ¥èŠ‚ç‚¹çš„çº¿å·®ä¸å¤šäº†ã€‚è¿™é‡Œè¦ç»˜åˆ¶çš„æ˜¯ä¸€ç§è¾ƒä¸ºç‰¹æ®Šçš„è´å¡å°”æ›²çº¿ï¼Œå®ƒçš„ä¸¤ä¸ªç«¯ç‚¹çš„åˆ‡çº¿æ˜¯æ°´å¹³çš„ï¼Œä¸”æ‹¥æœ‰æ—‹è½¬å¯¹ç§°çš„ç‰¹æ€§ã€‚</p><p>æˆ‘ä»¬æƒ³è¦ç»˜åˆ¶çš„Så½¢æ›²çº¿æ˜¯ä¸‰é˜¶çš„è´å¡å°”æ›²çº¿ã€‚ä¸‰é˜¶è´å¡å°”æ›²çº¿æœ‰å››ä¸ªæ§åˆ¶ç‚¹\(P_0, P_1, P_2, P_3\)ï¼Œå¯¹äºä¸€ä¸ªä»0åˆ°1çš„å˜é‡\(t\)ï¼Œè´å¡å°”æ›²çº¿çš„åšæ³•æ˜¯å¯¹è¿™å››ä¸ªç‚¹æŒ‰ç…§é¡ºåºä»¥\(t\)åšæ’å€¼ç”Ÿæˆä¸‰ä¸ªæ–°çš„ç‚¹ï¼Œç„¶åå¯¹è¿™ä¸‰ä¸ªç‚¹æŒ‰ç…§é¡ºåºä»¥\(t\)åšæ’å€¼ç”Ÿæˆæ–°çš„ä¸¤ä¸ªç‚¹ï¼Œå†å¯¹è¿™ä¸¤ä¸ªç‚¹ä»¥tåšæ’å€¼ç”Ÿæˆæœ€åçš„ç‚¹ï¼Œå½“tåœ¨0åˆ°1ä¸­å˜åŒ–æ—¶ï¼Œè¿™ä¸ªç‚¹çš„è½¨è¿¹å°±æ„æˆäº†è´å¡å°”æ›²çº¿ã€‚è´å¡å°”æ›²çº¿ä¸Šçš„ç‚¹å¯ä»¥ç”¨å››ä¸ªæ§åˆ¶ç‚¹å’Œ\(t\)æ¥è¡¨ç¤ºï¼š
$$
P_{bezier} = P_0 \cdot (1 - t)^3 + 3 P_1 \cdot (1 - t)^2 \cdot t + 3 P_2 \cdot (1 - t) \cdot t^2 + P_3 \cdot t^3
$$</p><p>å¦‚æœåˆå§‹å››ä¸ªç‚¹åˆ†åˆ«æ˜¯(0.0, 1.0), (d, 1.0), (1.0 - d, 0.0)ï¼Œå’Œ(1.0, 0.0)çš„è¯ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¦ç»˜åˆ¶çš„ç‰¹æ®Šçš„è´å¡å°”æ›²çº¿ï¼Œå¯ä»¥ç®—å‡ºè´å¡å°”æ›²çº¿çš„åæ ‡ä¸º
$$
P_{bezier} = ((3 t - 9t ^ 2 + 6t^3) \cdot d + 3t^2 - 2t^3, 1 - 3t^2 + 2t^3)
$$
ä½†æ˜¯å³ä½¿å¾—åˆ°äº†è´å¡å°”æ›²çº¿çš„å‚æ•°æ–¹ç¨‹ï¼Œæƒ³è¦å°†å…¶è¡¨è¾¾æˆ\(f(x)\)çš„å½¢å¼ä»ç„¶æ˜¯ç›¸å½“å›°éš¾çš„ã€‚Alan Wolfeåœ¨ä»–çš„åšå®¢ä¸­æåˆ°äº†ä¸€ç§<a href=https://blog.demofox.org/2014/08/28/one-dimensional-bezier-curves/>ä¸€ç»´è´å¡å°”æ›²çº¿</a>ï¼Œä¹Ÿæ˜¯ä¸€ç§è´å¡å°”æ›²çº¿çš„ç‰¹æ®Šæƒ…å†µï¼Œå››ä¸ªæ§åˆ¶ç‚¹åœ¨æ°´å¹³æ–¹å‘ä¸Šç­‰è·æ’å¼€ï¼Œè¿™æ ·å­è´å¡å°”æ›²çº¿çš„å‚æ•°æ–¹ç¨‹çš„æ°´å¹³åˆ†é‡å°±åˆšå¥½æ˜¯\(t\)ï¼Œå®ƒçš„ç«–ç›´åˆ†é‡ä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„\(f(x)\)ã€‚å”¯ä¸€ç¾ä¸­ä¸è¶³çš„æ˜¯ï¼Œèƒ½è½»æ˜“å¾—åˆ°\(f(x)\)çš„ä¸€ç»´è´èµ›å°”æ›²çº¿ï¼Œå¾€å¾€æ˜¯ä¸€ä¸ªâ€œèººå€’â€çš„è´èµ›å°”æ›²çº¿ï¼Œæ„Ÿå®˜ä¸Šçœ‹ä¸Šå»æ˜¯æ¨ªç€çš„ï¼ŒShadertoyä¸Šæœ‰ç›¸å…³çš„<a href=https://www.shadertoy.com/view/lsV3Wd>æ¼”ç¤º</a>ã€‚ä½†è¿™ç§ä¸€ç»´è´å¡å°”æ›²çº¿åˆæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œä¹Ÿå°±æ˜¯å‰ä¸¤ä¸ªæ§åˆ¶ç‚¹çš„ç«–ç›´é«˜åº¦ç›¸ç­‰ï¼Œåä¸¤ä¸ªæ§åˆ¶ç‚¹çš„ç«–ç›´é«˜åº¦ä¹Ÿç›¸ç­‰ï¼Œè¿™æ—¶è¿™ç§ç‰¹æ®Šçš„ä¸€ç»´è´å¡å°”æ›²çº¿å°±æ˜¯æˆ‘ä»¬è€³ç†Ÿèƒ½è¯¦çš„<code>smoothstep</code>æ›²çº¿äº†ï¼ˆæ•°å­¦çœŸå¥‡å¦™å•Šï¼‰ã€‚å¯æƒœ<code>smoothstep</code>ä¸èƒ½æ»¡è¶³æˆ‘ä»¬éšæ„æ§åˆ¶æ›²çº¿å½¢çŠ¶çš„éœ€æ±‚ï¼Œåªèƒ½å¦æ±‚ä»–æ³•ã€‚</p><p>äº‹å®ä¸Šæˆ‘ä»¬æƒ³è¦ç¡®ä¿ç»˜åˆ¶å‡ºçš„è´å¡å°”æ›²çº¿æ˜¯ç­‰å®½çš„ï¼Œä¹Ÿä¸èƒ½åªä½¿ç”¨æ›²çº¿çš„\(f(x)\)ï¼Œè¿™æ ·åªèƒ½ç¡®ä¿å…¶åœ¨ç«–ç›´æ–¹å‘æ˜¯ç­‰å®½çš„ã€‚éœ€è¦æ•´ä½“ç­‰å®½ï¼Œç­‰ä»·äºéœ€è¦çŸ¥é“å¹³é¢ä¸Šæ¯ä¸€ä¸ªç‚¹åˆ°è´å¡å°”æ›²çº¿çš„æœ€è¿‘è·ç¦»ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡çš„è·ç¦»åœºDistance Fieldäº†ã€‚è¦æ±‚ä»»æ„è´å¡å°”æ›²çº¿çš„è·ç¦»åœºï¼Œä¸æ˜¯ä¸€ä¸ªç‰¹åˆ«ç®€å•çš„äº‹æƒ…ï¼Œéœ€è¦ç‰›é¡¿è¿­ä»£æ³•ç­‰æ•°å­¦æ–¹æ³•ï¼Œä½†æ˜¯å¥½åœ¨Shadertoyä¸Šçš„ç”¨æˆ·<a href=https://www.shadertoy.com/user/NinjaKoala>NinjaKoala</a>å·²ç»å¸®æˆ‘ä»¬æŠŠè¿™ä¸ªé—®é¢˜è§£å†³äº†ï¼Œè€Œä¸”æ— ç§çš„æŠŠ<a href=https://www.shadertoy.com/view/4sKyzW>æºä»£ç </a>åˆ†äº«ç»™äº†æˆ‘ä»¬ã€‚æœ¬åšå®¢ä¸­ä½¿ç”¨çš„è·ç¦»åœºæ˜¯NinjaKoalaç»™å‡ºçš„ä¸€ç§<a href=https://www.shadertoy.com/view/3lsSzS>å¤§è‡´çš„è·ç¦»åœº</a>ï¼Œåœ¨è·ç¦»è´å¡å°”æ›²çº¿è¾ƒè¿œæ—¶ä¼šæœ‰ä¸€äº›åå·®ï¼Œä½†è¾ƒè¿‘çš„è·ç¦»åŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p><h2 id=ä¸€äº›å…¶ä»–çš„éœ€æ±‚>ä¸€äº›å…¶ä»–çš„éœ€æ±‚<a hidden class=anchor aria-hidden=true href=#ä¸€äº›å…¶ä»–çš„éœ€æ±‚>#</a></h2><p>å·²ç»åŸºæœ¬çŸ¥é“è¯¥æ€ä¹ˆç»˜åˆ¶è´å¡å°”æ›²çº¿äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘åˆ°åœ¨ä½¿ç”¨Shaderæ—¶å€™çš„ä¸€äº›éœ€æ±‚ã€‚æˆ‘ä»¬è¦è€ƒè™‘çš„ä¸ä»…ä»…æ˜¯è°ƒæ•´é¢œè‰²ã€å®½åº¦ã€é˜´å½±ç­‰å‚æ•°ï¼Œè€Œæ˜¯è¿™ä¸ªShaderå°†è¦å¦‚ä½•æ”¾åˆ°å±å¹•ä¸Šã€‚</p><p>æ­£å¸¸æ¥è¯´ç­–åˆ’ä¼šæŒ‡å®šä¸¤ä¸ªé¡¶ç‚¹ï¼Œè¯´åœ¨è¿™ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´ç”»ä¸€æ¡è´èµ›å°”æ›²çº¿ï¼Œè¿™æ—¶ç¨‹åºä¼šç»™æˆ‘ä»¬ä¸¤ä¸ªå±å¹•ç©ºé—´åæ ‡ï¼ˆåœ¨Unityä¸­å°±æ˜¯RectTransformçš„åæ ‡äº†ï¼‰ï¼Œæ ¹æ®è¿™ä¸¤ä¸ªåæ ‡ä½¿ç”¨<code>Image</code>è¿™ä¸ªç»„ä»¶ï¼Œåœ¨å±å¹•ä¸Šç”¨æˆ‘ä»¬å†™çš„Shaderçš„æè´¨æ¸²æŸ“ä¸€ä¸ªQuadã€‚</p><p>ä½†æ˜¯äº‹æƒ…å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼ŒQuadçš„é¡¶ç‚¹æ˜¯è´å¡å°”æ›²çº¿çš„ä¸¤ä¸ªç«¯ç‚¹çš„è¯ï¼Œä¸€ä¸ªç­‰å®½çš„è´èµ›å°”æ›²çº¿å°±ä¼šè¶…å‡ºQuadçš„èŒƒå›´ï¼Œæ›´ä¸è¦è¯´è¿˜æœ‰ä¸€æ®µåç§»å’Œæ¨¡ç³Šçš„é˜´å½±äº†ã€‚å› æ­¤æˆ‘ä»¬è¦åšæ˜¯åœ¨ç»˜åˆ¶ç»™å®šå››ä¸ªé¡¶ç‚¹çš„Quadæ—¶ï¼Œåœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å°†å…¶é¡¶ç‚¹å‘å¤–åç§»ä¸€å®šçš„æ•°é‡ï¼Œè®©æ•´æ¡è´å¡å°”æ›²çº¿å’Œå…¶é˜´å½±éƒ½èƒ½è½åœ¨æ‰©å¤§åçš„Quadçš„èŒƒå›´ä¸­ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæœ¬æ¥æ¶ˆè€—å¾ˆé«˜çš„è½¯é˜´å½±ï¼ˆéœ€è¦å¾ˆå¤šæ¬¡é‡‡æ ·ï¼‰ï¼Œåœ¨è·å¾—äº†è·ç¦»åœºä¹‹åï¼Œå¯ä»¥é€šè¿‡æ™®é€šçš„<code>lerp</code>æˆ–è€…<code>Smoothstep</code>ç›´æ¥ç”Ÿæˆï¼Œä¹Ÿæ˜¯å¯å–œå¯è´ºçš„ä¸€ä»¶äº‹ã€‚</p><h2 id=å…·ä½“çš„å®æ–½æ­¥éª¤>å…·ä½“çš„å®æ–½æ­¥éª¤<a hidden class=anchor aria-hidden=true href=#å…·ä½“çš„å®æ–½æ­¥éª¤>#</a></h2><ol><li>åœ¨<code>Canvas</code>ä¸­åˆ›å»ºä¸€ä¸ª<code>Image</code>ç»„ä»¶ï¼ŒæŒ‚ä¸Šæˆ‘ä»¬çš„æè´¨çƒå’Œ<code>DrawBezierCurve</code>è„šæœ¬ã€‚</li><li>åœ¨<code>DrawBezierCurve</code>è„šæœ¬ä¸­è·å–<code>Image</code>ç»„ä»¶çš„åƒç´ å•ä½çš„å®½å’Œé«˜ï¼ˆå…¶å®åªè¦é«˜å°±è¡Œäº†ï¼‰ï¼Œå°†è¿™ä¸ªå€¼ä¼ ç»™Shaderã€‚</li><li>é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼Œé¦–å…ˆéœ€è¦å°†Quadä¸Šæ–¹çš„ä¸¤ä¸ªé¡¶ç‚¹å¾€ä¸Šç§»åŠä¸ªè´å¡å°”æ›²çº¿çš„å®½åº¦ä¸ªåƒç´ <code>heightA = _Width * 0.5</code>ï¼Œç„¶åè¦å°†Quadä¸‹æ–¹çš„ä¸¤ä¸ªé¡¶ç‚¹å¾€ä¸‹ç§»é˜´å½±åç§»åŠ åŠä¸ªé˜´å½±å®½åº¦ä¸ªåƒç´ <code>heightC = _ShadowOffset + _ShadowWidth * 0.5</code>ã€‚åœ¨uvçš„æ—¶å€™è¦ç¡®ä¿åç§»ä¹‹åçš„uvåœ¨åŸQuadèŒƒå›´å†…ä»æ˜¯0-1ä¹‹é—´çš„ã€‚è¿™ä¸€æ­¥å¯¹æœ€ç»ˆçš„æ•ˆæœè‡³å…³é‡è¦ï¼</li><li>ç‰‡å…ƒç€è‰²å™¨ä¸­ï¼Œä½¿ç”¨<code>ddx(uv.x)</code>å’Œ<code>ddy(uv.y)</code>ï¼Œå¯ä»¥è®¡ç®—å‡ºè´å¡å°”æ›²çº¿çš„ä»¥åƒç´ ä¸ºå•ä½çš„è·ç¦»åœºï¼ˆä¹Ÿèƒ½ç”¨C#è„šæœ¬ä¼ å…¥çš„Quadçš„é«˜å’Œå®½æ¥ç®—ï¼Œä¸è¿‡åº”è¯¥æ˜¯ddxæ¯”è¾ƒæ–¹ä¾¿ï¼‰ã€‚ä½¿ç”¨<code>smoothstep</code>å°±èƒ½ç»˜åˆ¶å‡ºæŠ—é”¯é½¿çš„è´å¡å°”æ›²çº¿ï¼Œæˆ–æ˜¯æ¨¡ç³Šçš„é˜´å½±äº†ã€‚</li></ol><h3 id=drawbeziercurvecs>DrawBezierCurve.cs<a hidden class=anchor aria-hidden=true href=#drawbeziercurvecs>#</a></h3><p>Updateçš„æ—¶å€™è¦è®°å¾—æ‹¿åˆ°å¯¹åº”çš„æè´¨çš„å¼•ç”¨ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine.UI;
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>[ExecuteInEditMode]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>[RequireComponent(typeof(Image))]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>[RequireComponent(typeof(RectTransform))]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DrawBezierCurve</span> : MonoBehaviour
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Image image;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> RectTransform rectTransform;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Material material;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> OnEnable()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        image = GetComponent&lt;Image&gt;();
</span></span><span style=display:flex><span>        material = <span style=color:#66d9ef>new</span> Material(image.material);
</span></span><span style=display:flex><span>        image.material = material;
</span></span><span style=display:flex><span>        rectTransform = GetComponent&lt;RectTransform&gt;();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> Update()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Vector2 bottomLeftCorner = rectTransform.anchoredPosition + rectTransform.rect.min;
</span></span><span style=display:flex><span>        Vector2 topRightCorner = rectTransform.anchoredPosition + rectTransform.rect.max;
</span></span><span style=display:flex><span>        Vector4 anchorPos = <span style=color:#66d9ef>new</span> Vector4(bottomLeftCorner.x, bottomLeftCorner.y, topRightCorner.x, topRightCorner.y);
</span></span><span style=display:flex><span>        material.SetVector(<span style=color:#e6db74>&#34;_AnchorPos&#34;</span>, anchorPos);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=beziershadershader>BezierShader.shader<a hidden class=anchor aria-hidden=true href=#beziershadershader>#</a></h3><p>è´å¡å°”çš„è·ç¦»åœºæ¥è‡ª<a href=https://www.shadertoy.com/view/3lsSzS>Cubic bezier approx distance 2</a>ã€‚</p><p>æˆ‘è¿˜å¢åŠ äº†é€‰é¡¹ï¼Œåœ¨æ˜¾ç¤ºä¸€æ¡æ¨ªçº¿æ—¶å…³é—­<code>BEZIERCURVE</code>å°±èƒ½ä½¿ç”¨æ•ˆç‡æ›´é«˜çš„æ¨ªçº¿çš„è·ç¦»åœºäº†ï¼ˆè¦æ³¨æ„ç»˜åˆ¶æ¨ªçº¿æ—¶ï¼Œ<code>RectTransform</code>ä¸­<code>Height</code>çš„å€¼ä¸èƒ½è®¾ç½®æˆ0ï¼Œæœ€å¥½è®¾ç½®æˆä¸€ä¸ªå¦‚0.01çš„å°æ•°ï¼‰ï¼ŒåŒæ—¶ä¹Ÿæ·»åŠ äº†æ°´å¹³ç¿»è½¬çš„é€‰é¡¹ã€‚</p><p>è´å¡å°”æ›²çº¿å’Œé˜´å½±æ··åˆä¹‹åå†å‚åŠ é€æ˜åº¦æ··åˆï¼Œä¼šç»™è´å¡å°”æ›²çº¿å¸¦ä¸Šä¸€æ¡æµ…æµ…çš„é˜´å½±é¢œè‰²çš„æè¾¹ï¼Œæ•ˆæœè¿˜ç®—ä¸é”™ï¼Œè¿™é‡Œå°±æš‚æ—¶ä¸ä¿®æ”¹äº†ã€‚ä½†æ˜¯å¦‚æœä¸æƒ³è¦è¿™ä¸ªæè¾¹çš„è¯ã€‚éœ€è¦é¢„å…ˆè®¡ç®—å‡ºæ··åˆåçš„é¢œè‰²å€¼å’Œé€æ˜åº¦å€¼ã€‚å¦‚æœç”¨\((c_1, a_1)\)ã€\((c_2, a_2)\)ã€\((c_0)\)æ¥åˆ†åˆ«è¡¨ç¤ºæ›²çº¿å’Œé˜´å½±çš„é¢œè‰²å€¼ã€é€æ˜åº¦å€¼å’Œé€æ˜åº¦æ··åˆæ—¶ç›®æ ‡çš„é¢œè‰²çš„è¯ï¼ˆä»å‰å¾€åçš„é¡ºåºåº”è¯¥æ˜¯æ›²çº¿\((c_1, a_1)\)ï¼Œé˜´å½±\((c_2, a_2)\)å’Œé€æ˜åº¦æ··åˆç›®æ ‡\((c_0)\)ï¼‰ï¼Œæ­£ç¡®çš„é€æ˜åº¦æ··åˆçš„é¢œè‰²åº”è¯¥æ˜¯\(c_1 a_1 + c_2 a_2 (1 - a_1) + c_0 (1 - a_1) (1 - a_2)\)ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®é€æ˜åº¦æ··åˆæ¨¡å¼ä¸º<code>Blend One SrcAlpha</code>ï¼Œç„¶åå°†è¾“å‡ºçš„é¢œè‰²è®¾ç½®æˆ<code>float4(c1 * a1 + c2 * a2 * (1 - a1), (1 - a1) * (1 - a2))</code>ï¼Œè¿™æ ·æ··åˆåçš„é¢œè‰²å°±æ˜¯å®Œç¾çš„æ­£å¸¸çš„é€æ˜åº¦æ··åˆäº†ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-HLSL data-lang=HLSL><span style=display:flex><span><span style=color:#75715e>//Based on https://www.shadertoy.com/view/3lsSzS</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Shader <span style=color:#e6db74>&#34;zznewclear13/BezierShader&#34;</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Properties
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        [HideInInspector] _MainTex (<span style=color:#e6db74>&#34;Main Texture&#34;</span>, <span style=color:#ae81ff>2</span>D) <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;white&#34;</span> {}
</span></span><span style=display:flex><span>        [Header(Marcos)]
</span></span><span style=display:flex><span>        [Toggle(BEZIERCURVE)] _BezierCurve(<span style=color:#e6db74>&#34;Bezier Curve&#34;</span>, <span style=color:#66d9ef>float</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        [Toggle(FLIP)] _Flip (<span style=color:#e6db74>&#34;Flip&#34;</span>, <span style=color:#66d9ef>float</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        [Header(Curve Settings)]
</span></span><span style=display:flex><span>        _Color (<span style=color:#e6db74>&#34;Color&#34;</span>, Color) <span style=color:#f92672>=</span> (<span style=color:#ae81ff>1.0</span>, <span style=color:#ae81ff>1.0</span>, <span style=color:#ae81ff>1.0</span>, <span style=color:#ae81ff>1.0</span>)
</span></span><span style=display:flex><span>        _Curve (<span style=color:#e6db74>&#34;Curve&#34;</span>, range(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.2</span>
</span></span><span style=display:flex><span>        _Width (<span style=color:#e6db74>&#34;Pixel Width&#34;</span>, <span style=color:#66d9ef>float</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>        [Header(Shadow Settings)]
</span></span><span style=display:flex><span>        _ShadowColor (<span style=color:#e6db74>&#34;Shadow Color&#34;</span>, color) <span style=color:#f92672>=</span> (<span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>        _ShadowOffset (<span style=color:#e6db74>&#34;Shadow Offset&#34;</span>, <span style=color:#66d9ef>float</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>        _ShadowWidth (<span style=color:#e6db74>&#34;Shadow Width&#34;</span>, <span style=color:#66d9ef>float</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    HLSLINCLUDE
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>#</span>include <span style=color:#e6db74>&#34;Packages/com.unity.render-pipelines.core/ShaderLibrary/Common.hlsl&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>#</span>include <span style=color:#e6db74>&#34;Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>#</span>pragma multi_compile_local _ FLIP
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>#</span>pragma multi_compile_local _ BEZIERCURVE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    sampler2D _MainTex;
</span></span><span style=display:flex><span>    CBUFFER_START(UnityPerMaterial)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float4</span> _Color;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> _Curve;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> _Width;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float4</span> _ShadowColor;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> _ShadowOffset;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> _ShadowWidth;
</span></span><span style=display:flex><span>    CBUFFER_END
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float4</span> _AnchorPos;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>float2</span> VertexOffsets[] <span style=color:#f92672>=</span> 
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span>(<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span>(<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>struct</span> Attributes
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>uint</span> vertexID       <span style=color:#f92672>:</span> SV_VERTEXID;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float4</span> positionOS   <span style=color:#f92672>:</span> POSITION;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> texcoord     <span style=color:#f92672>:</span> TEXCOORD0;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>struct</span> Varyings
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float4</span> positionCS   <span style=color:#f92672>:</span> SV_POSITION;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> uv           <span style=color:#f92672>:</span> TEXCOORD0;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Varyings Vert(Attributes input)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Varyings output <span style=color:#f92672>=</span> (Varyings)<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float4</span> positionOS <span style=color:#f92672>=</span> input.positionOS;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> heightA <span style=color:#f92672>=</span> _Width <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.5</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> heightB <span style=color:#f92672>=</span> _AnchorPos.w <span style=color:#f92672>-</span> _AnchorPos.y;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> heightC <span style=color:#f92672>=</span> _ShadowOffset <span style=color:#f92672>+</span> _ShadowWidth <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        positionOS.y <span style=color:#f92672>+=</span> VertexOffsets[input.vertexID].x <span style=color:#f92672>*</span> heightA <span style=color:#f92672>+</span> VertexOffsets[input.vertexID].y <span style=color:#f92672>*</span> heightC;
</span></span><span style=display:flex><span>        VertexPositionInputs vertexInput <span style=color:#f92672>=</span> GetVertexPositionInputs(positionOS);
</span></span><span style=display:flex><span>        output.positionCS <span style=color:#f92672>=</span> vertexInput.positionCS;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//0-1 -&gt; -(heightC) / heightB, (heightA + heightB + heightC) / heightB</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> newCoordY <span style=color:#f92672>=</span> (heightA <span style=color:#f92672>+</span> heightB <span style=color:#f92672>+</span> heightC) <span style=color:#f92672>/</span> heightB <span style=color:#f92672>*</span> input.texcoord.y <span style=color:#f92672>-</span> (heightC) <span style=color:#f92672>/</span> heightB ;
</span></span><span style=display:flex><span>        output.uv <span style=color:#f92672>=</span> <span style=color:#66d9ef>float2</span>(input.texcoord.x, newCoordY);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> output;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> cubic_bezier_normal_iteration(<span style=color:#66d9ef>float</span> t, <span style=color:#66d9ef>float2</span> a0, <span style=color:#66d9ef>float2</span> a1, <span style=color:#66d9ef>float2</span> a2, <span style=color:#66d9ef>float2</span> a3)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>//factor should be positive</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//it decreases the step size when lowered.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//Lowering the factor and increasing iterations increases the area in which</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//the iteration converges, but this is quite costly</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>float</span> factor<span style=color:#f92672>=</span><span style=color:#ae81ff>1.</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>//horner&#39;s method</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> a_2<span style=color:#f92672>=</span>a2<span style=color:#f92672>+</span>t<span style=color:#f92672>*</span>a3;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> a_1<span style=color:#f92672>=</span>a1<span style=color:#f92672>+</span>t<span style=color:#f92672>*</span>a_2;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> b_2<span style=color:#f92672>=</span>a_2<span style=color:#f92672>+</span>t<span style=color:#f92672>*</span>a3;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> uv_to_p<span style=color:#f92672>=</span>a0<span style=color:#f92672>+</span>t<span style=color:#f92672>*</span>a_1;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> tang<span style=color:#f92672>=</span>a_1<span style=color:#f92672>+</span>t<span style=color:#f92672>*</span>b_2;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> l_tang<span style=color:#f92672>=</span>dot(tang,tang);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t<span style=color:#f92672>-</span>factor<span style=color:#f92672>*</span>dot(tang,uv_to_p)<span style=color:#f92672>/</span>l_tang;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> cubic_bezier_dis_approx_sq(<span style=color:#66d9ef>float2</span> uv, <span style=color:#66d9ef>float2</span> p0, <span style=color:#66d9ef>float2</span> p1, <span style=color:#66d9ef>float2</span> p2, <span style=color:#66d9ef>float2</span> p3)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> a3 <span style=color:#f92672>=</span> (<span style=color:#f92672>-</span>p0 <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.</span> <span style=color:#f92672>*</span> p1 <span style=color:#f92672>-</span> <span style=color:#ae81ff>3.</span> <span style=color:#f92672>*</span> p2 <span style=color:#f92672>+</span> p3);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> a2 <span style=color:#f92672>=</span> (<span style=color:#ae81ff>3.</span> <span style=color:#f92672>*</span> p0 <span style=color:#f92672>-</span> <span style=color:#ae81ff>6.</span> <span style=color:#f92672>*</span> p1 <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.</span> <span style=color:#f92672>*</span> p2);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> a1 <span style=color:#f92672>=</span> (<span style=color:#f92672>-</span><span style=color:#ae81ff>3.</span> <span style=color:#f92672>*</span> p0 <span style=color:#f92672>+</span> <span style=color:#ae81ff>3.</span> <span style=color:#f92672>*</span> p1);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> a0 <span style=color:#f92672>=</span> p0 <span style=color:#f92672>-</span> uv;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> d0 <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>e38;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> t0<span style=color:#f92672>=</span><span style=color:#ae81ff>0.</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> t;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> num_iterations<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> num_start_params<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;i<span style=color:#f92672>&lt;</span>num_start_params;i<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            t<span style=color:#f92672>=</span>t0;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;j<span style=color:#f92672>&lt;</span>num_iterations;j<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                t<span style=color:#f92672>=</span>cubic_bezier_normal_iteration(t,a0,a1,a2,a3);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            t<span style=color:#f92672>=</span>clamp(t,<span style=color:#ae81ff>0.</span>,<span style=color:#ae81ff>1.</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>float2</span> uv_to_p<span style=color:#f92672>=</span>((a3<span style=color:#f92672>*</span>t<span style=color:#f92672>+</span>a2)<span style=color:#f92672>*</span>t<span style=color:#f92672>+</span>a1)<span style=color:#f92672>*</span>t<span style=color:#f92672>+</span>a0;
</span></span><span style=display:flex><span>            d0<span style=color:#f92672>=</span>min(d0,dot(uv_to_p,uv_to_p));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            t0<span style=color:#f92672>+=</span><span style=color:#ae81ff>1.</span><span style=color:#f92672>/</span><span style=color:#66d9ef>float</span>(num_start_params<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> d0;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> cubic_bezier_dis_approx(<span style=color:#66d9ef>float2</span> uv, <span style=color:#66d9ef>float2</span> p0, <span style=color:#66d9ef>float2</span> p1, <span style=color:#66d9ef>float2</span> p2, <span style=color:#66d9ef>float2</span> p3)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> sqrt(cubic_bezier_dis_approx_sq(uv,p0,p1,p2,p3));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float4</span> Frag(Varyings input) <span style=color:#f92672>:</span> SV_TARGET
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> ddxX <span style=color:#f92672>=</span> ddx(input.uv.x);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> ddyY <span style=color:#f92672>=</span> ddy(input.uv.y);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> scale <span style=color:#f92672>=</span> <span style=color:#66d9ef>float2</span>(rcp(ddxX), rcp(ddyY));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> coord <span style=color:#f92672>=</span> input.uv;
</span></span><span style=display:flex><span><span style=color:#75715e>#if FLIP</span>
</span></span><span style=display:flex><span>        coord.x <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> coord.x;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#if BEZIERCURVE</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> p0<span style=color:#f92672>=</span><span style=color:#66d9ef>float2</span>(<span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>1.0</span>) <span style=color:#f92672>*</span> scale;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> p1<span style=color:#f92672>=</span><span style=color:#66d9ef>float2</span>(_Curve, <span style=color:#ae81ff>1.0</span>) <span style=color:#f92672>*</span> scale;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> p2<span style=color:#f92672>=</span><span style=color:#66d9ef>float2</span>(<span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> _Curve, <span style=color:#ae81ff>0.0</span>) <span style=color:#f92672>*</span> scale;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float2</span> p3<span style=color:#f92672>=</span><span style=color:#66d9ef>float2</span>(<span style=color:#ae81ff>1.0</span>, <span style=color:#ae81ff>0.0</span>) <span style=color:#f92672>*</span> scale;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> dist <span style=color:#f92672>=</span> cubic_bezier_dis_approx(coord <span style=color:#f92672>*</span> scale,p0,p1,p2,p3);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> widthVal <span style=color:#f92672>=</span> _Width <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.5</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> alpha <span style=color:#f92672>=</span> smoothstep(widthVal <span style=color:#f92672>+</span> <span style=color:#ae81ff>1.0</span>, widthVal, dist);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> shadowDist <span style=color:#f92672>=</span> cubic_bezier_dis_approx(coord <span style=color:#f92672>*</span> scale <span style=color:#f92672>+</span> <span style=color:#66d9ef>float2</span>(<span style=color:#ae81ff>0.0</span>, _ShadowOffset),p0,p1,p2,p3);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> shadowWidthVal <span style=color:#f92672>=</span> _ShadowWidth <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.5</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> shadowAlpha <span style=color:#f92672>=</span> smoothstep(shadowWidthVal <span style=color:#f92672>+</span> <span style=color:#ae81ff>1.0</span>, <span style=color:#ae81ff>0.0</span>, shadowDist);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#else</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> dist <span style=color:#f92672>=</span> abs((<span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> coord.y) <span style=color:#f92672>*</span> scale.y);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> widthVal <span style=color:#f92672>=</span> _Width <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.5</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> alpha <span style=color:#f92672>=</span> smoothstep(widthVal <span style=color:#f92672>+</span> <span style=color:#ae81ff>1.0</span>, widthVal, dist);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> shadowDist <span style=color:#f92672>=</span> abs((<span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> coord.y) <span style=color:#f92672>*</span> scale.y <span style=color:#f92672>-</span> _ShadowOffset);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> shadowWidthVal <span style=color:#f92672>=</span> _ShadowWidth <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.5</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> shadowAlpha <span style=color:#f92672>=</span> smoothstep(shadowWidthVal <span style=color:#f92672>+</span> <span style=color:#ae81ff>1.0</span>, <span style=color:#ae81ff>0.0</span>, shadowDist);
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float3</span> color <span style=color:#f92672>=</span> lerp(_ShadowColor.rgb, _Color.rgb, alpha <span style=color:#f92672>*</span> _Color.a);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> finalAlpha <span style=color:#f92672>=</span> max(alpha <span style=color:#f92672>*</span> _Color.a, shadowAlpha <span style=color:#f92672>*</span> _ShadowColor.a);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float4</span> returnColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>float4</span>(color, finalAlpha);
</span></span><span style=display:flex><span>        <span style=color:#75715e>//returnColor = float4(input.uv, 0.0, 1.0);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> returnColor;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ENDHLSL
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    SubShader
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Tags{ <span style=color:#e6db74>&#34;Queue&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Transparent&#34;</span> <span style=color:#e6db74>&#34;RenderType&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Transparent&#34;</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Cull Back
</span></span><span style=display:flex><span>            ZTest LEqual
</span></span><span style=display:flex><span>            ZWrite Off
</span></span><span style=display:flex><span>            Blend SrcAlpha OneMinusSrcAlpha
</span></span><span style=display:flex><span>            HLSLPROGRAM
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>#</span>pragma vertex Vert
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>#</span>pragma fragment Frag
</span></span><span style=display:flex><span>            ENDHLSL
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=æœ€åçš„æ€è€ƒ>æœ€åçš„æ€è€ƒ<a hidden class=anchor aria-hidden=true href=#æœ€åçš„æ€è€ƒ>#</a></h2><p>æ•°å­¦çœŸå¥‡å¦™å•Šï¼ä¹Ÿå¾ˆæ„Ÿè°¢Shadertoyä¸Šç”¨æˆ·ä»¬çš„æ— ç§çš„å¥‰çŒ®ï¼ä½†æ˜¯å¾®ç§¯åˆ†å¯¹æˆ‘æ¥è¯´è¿˜æ˜¯å¤ªéš¾äº†ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥æ‰¾ä¸ªæœºä¼šè¡¥ä¸€è¡¥å‘¢ã€‚ã€‚ã€‚æœ€åå°±æ˜¯æˆ‘æ„Ÿè§‰å¯¹<code>fwidth</code>æŠ—é”¯é½¿çš„ç†è§£åˆåŠ æ·±äº†ï¼</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://zznewclear13.github.io/tags/anti-aliasing/>Anti-Aliasing</a></li><li><a href=https://zznewclear13.github.io/tags/bezier-curve/>Bezier Curve</a></li><li><a href=https://zznewclear13.github.io/tags/signed-distance-field/>Signed Distance Field</a></li></ul><nav class=paginav><a class=prev href=https://zznewclear13.github.io/posts/create-plant-swaying-in-wind-using-vertex-animation/><span class=title>Â« Prev</span><br><span>ä½¿ç”¨é¡¶ç‚¹åŠ¨ç”»åˆ¶ä½œéšé£é£˜åŠ¨çš„æ¤ç‰©</span>
</a><a class=next href=https://zznewclear13.github.io/posts/draw-equal-width-outline-in-unity/><span class=title>Next Â»</span><br><span>åœ¨Unityä¸­ç»˜åˆ¶ç­‰å®½çš„æè¾¹</span></a></nav></footer><div id=comments></div><script>let currentHugoTheme=window.localStorage.getItem("pref-theme");function loadComment(){const t=document.getElementById("comments");let n=currentHugoTheme=="dark"?"photon-dark":"github-light",e=document.createElement("script");e.src="https://utteranc.es/client.js",e.setAttribute("repo","zznewclear13/zznewclear13.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("label","utterances"),e.setAttribute("theme",n),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",""),t.innerHTML="",t.appendChild(e)}loadComment(),document.getElementById("theme-toggle").onclick=async()=>{await new Promise(e=>setTimeout(e,200));let e=window.localStorage.getItem("pref-theme");e!=currentHugoTheme&&(currentHugoTheme=e,loadComment())}</script></article></main><footer class=footer><span>&copy; 2024 <a href=https://zznewclear13.github.io/>ZZNEWCLEAR13</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>